
######################################################################################################################################################
######################################################                                             ###################################################
######################################################           09_windows_process_validity      ####################################################
######################################################                                             ###################################################
######################################################################################################################################################


######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************


######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************

######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************
######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************

######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************

######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************

######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************

######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************

######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************

######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************

######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************

######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************


######################################################### Windows_Processes_Basics_3 5 #########################################################

What Sysinternals tool shows malware persistence locations in tabs within its GUI?

Research: https://learn.microsoft.com/en-us/sysinternals

********************************************************* SOLUTION ********************************************************

Autoruns

######################################################### Windows_Processes_Basics_2 5 #########################################################

What Sysinternals tool is used to investigate processes?

********************************************************* SOLUTION ********************************************************

Procexp

######################################################### Windows_Processes_Basics_3 5 #########################################################

What Sysinternals tool can be used to investigate network connection attempts?

********************************************************* SOLUTION ********************************************************

TCPView

######################################################### Windows_Processes_Basics_4 5 #########################################################

What Sysinternals tool can view permissions?

********************************************************* SOLUTION ********************************************************

AccessChk

######################################################### Windows_Processes_Basics_5 5 #########################################################

What Sysinternals tool allows us to view and modify handles?

********************************************************* SOLUTION ********************************************************

handle

######################################################### Windows_Processes_Basics_6 5 #########################################################

What is the default Windows user directory for files downloaded from the internet? The flag is the folder name only.

********************************************************* SOLUTION ********************************************************

Downloads

######################################################### Windows_Processes_Basics_7 5 #########################################################

What is the default Windows download directory that everyone has access to? The flag is the absolute path to the directory.

********************************************************* SOLUTION ********************************************************

C:\Users\Public\Downloads

######################################################### Windows_Processes_Basics_8 5 #########################################################

What Sysinternals tool shows service load order?

********************************************************* SOLUTION ********************************************************

LoadOrd

######################################################### Windows_Processes_Basics_9 5 #########################################################

What is the service name of Windows Defender Firewall?

********************************************************* SOLUTION ********************************************************

Mpssvc

######################################################### Windows_Processes_Basics_10 5 #########################################################

What SysInternals tool reports .dlls loaded into processes?

********************************************************* SOLUTION ********************************************************

ListDLLs

######################################################### Windows_Hidden_Processes_1 10 #########################################################

There is malware on the system that is named similarly to a legitimate Windows executable. There is a .dll in the folder that the malware runs from. The flag is the name of the .dll.

Reminder: All challenges are done using Workstation1.

********************************************************* SOLUTION ********************************************************

go to command prompt and run these:
net use z: /d
xcopy /s z:\ c:\sysinternals\
net use * http://live.sysinternals.com # Autoruns directory should now be available 

got to the c directory and open autoruns 

look for a suspicious exe and cd to the directory to find the .dll 

In this case, TotallyLegit that resides in C:\Users\Public\Downloads\


######################################################### Windows_Hidden_Processes_2 10 #########################################################

You notice that there is an annoying pop up happening regularly. Investigate the process causing it. The flag is the name of the executable.

********************************************************* SOLUTION ********************************************************

Go to Autoruns and go to scheduled task........ McAfee Keep-alive looks suscpicious

right click and do Jump to Entry 
Select McAfee Keep Alive and select Actions....> Expand the pipe in the box to see the .exe file -> McAfeeFireTray.exe

######################################################### Windows_Hidden_Processes_3 10 #########################################################

Determine what is sending out a SYN_SENT message. The flag is the name of the executable.

HINT: Use a Sysinternals tool.

********************************************************* SOLUTION ********************************************************

Open TCPView

Get-NetTCPConnection -State SynSent #powershell

Run TCP View

Sort by name or state

Find synsent -> answer is McAfeeFireTray.exe

######################################################### Windows_Hidden_Processes_4 10 #########################################################

Malware uses names of legit processes to obfuscate itself. Give the flag located in Kerberos’ registry subkey.

HINT: Use Sysinternals tools.

Machine: Workstation1 (RDP from Admin-Station)
login: student
password: password

********************************************************* SOLUTION ********************************************************


HINT: Use Sysinternals tools.

Creds:

Machine: Workstation1 (RDP from Admin-Station)

login: student

password: password

- search for Kerberos in Autorun......... Right click and Jumpt to Entry------Click paramerts

- flag: H4d3S

OR

Open autoruns (sysinternals)

Search kerberos in search bar that says quick filter

Right click on Kerberos -> Jump to entry -> run as admin -> yes (do again if nothing happens)

Expand Kerberos folder on left-hand side -> click PARAMETERS

Flag: H4d3S

This is the path at the top: Computer\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Kerberos\Parameters



######################################################### Windows_Hidden_Processes_5 10 #########################################################

There is malware named TotallyLegit. Find its binary location and there will be a file in that directory. Read the file.

HINT: Use Sysinternals tools.

********************************************************* SOLUTION ********************************************************

HINT: Use Sysinternals tools.

- go to AutoRuns--- search for TotallyLegit

- right click and Jump to Entry

- this gives the path----- 
cd to the path 
type Hmmm.txt # read the contents of the file, same as cat 

L3gitness 

######################################################### Windows_Hidden_Processes_6 10 #########################################################

Find the McAfeeFireTray.exe. There is a file in that directory. The flag is inside.

HINT: Use Sysinternals tools.

Machine: Workstation1 (RDP from Admin-Station)
login: student
password: password

********************************************************* SOLUTION ********************************************************

use the search bar in autoruns to find the exe -> McAfeeFireTray.exe

then cd to the location SecureHealth (Not Verified) 	C:\Program Files\Windows Defender Advanced Threat Protection\McAfeeFireTray.exe	

type It's_Here.txt


- autorun search for the file----right click jump --- this gives file path

- C:\Program Files\Windows Defender Advanced Threat Protection

(Get-Acl "C:\Windows\System32\spoolsv.exe").Access | Where-Object { $_.IdentityReference -eq "NT SERVICE\TrustedInstaller" }

Get-ChildItem -Path C:\ -Recurse -Filter spoolsv.exe -ErrorAction SilentlyContinue | Where-Object { !$_.PSIsContainer }

######################################################### Win_Process_Situational_Awareness_1 10 #########################################################

What are the permissions for NT SERVICE\TrustedInstaller on spoolsv.exe? Copy the permissions from your shell.

HINT: Use Sysinternals tools.

********************************************************* SOLUTION ********************************************************

Get-ChildItem -Path C:\ -Recurse -Filter spoolsv.exe -ErrorAction SilentlyContinue | Where-Object { !$_.PSIsContainer } # Find where the file is


icacls "C:\windows\System32\spoolsv.exe" #which shows (F) for Full Control, answer will be Read Write for full control 


&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& another way &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

Get-Process | ? { $.Path -like '*spoolsv.exe' } | % { $.Handle }

Handle -> different everytime

Get-ChildItem -Path C:\ -Include "spoolsv" -File -Recurse #search for name of file

Directory: C:\Windows\System32\en-US

Cd C:\Windows\System32\en-US

(get-acl spoolsv.exe.mui).access | ft

Read,write

#OR

C:\Users\student\desktop\accesschk.exe C:\Windows\System32\spoolsv.exe

NT SERVICE\TrustedInstaller will show RW

#OR

Can also run:

icacls "C:\windows\System32\spoolsv.exe" #which shows (F) for Full Control #https://www.varonis.com/blog/ntfs-permissions-vs-share Full Control = read, write and change, does not include execute


######################################################### Win_Process_Situational_Awareness_2 10 #########################################################

What is the PATH listed in the output when we find the handle for spoolsv.exe?

HINT: Use Sysinternals tools and don't forget to run as Administrator...


********************************************************* SOLUTION ********************************************************


Open Process Explorer as administrator

Find spool in the top left search bar # view -> show lower pane 

C:\Windows\System32\en-US\spoolsv.exe.mui

Go to options > lower Pane > DLL

Under lowerpane find spoolsv.exe.mui

Right click properties and see path

C:\Windows\System32\en-US\spoolsv.exe.mui 

######################################################### Win_Process_Situational_Awareness_3 10 #########################################################



######################################################### Win_Process_Situational_Awareness_3 10 #########################################################

In what Load Order Group is the Windows Firewall service?

HINT: Use Sysinternals tools.

********************************************************* SOLUTION ********************************************************

net use * http://live.sysinternals.com
find loadOrder system tool 
look for the service name for windows firewall service on google, it should be MPSSVC. Now look at the group name
Answer should be Network Provider


######################################################### Win_Process_Situational_Awareness_4 10 #########################################################

What is the first .dll associated with winlogon.exe? Provide the name of the .dll only, not the /absolute/path

HINT: Use Sysinternals tools.

********************************************************* SOLUTION ********************************************************

open command prompt as administrator 

cd to the mounted directory 

listdlls -v winlogon.exe

look at the first dlls which is ntdll

######################################################### Win_Process_Situational_Awareness_5 10 #########################################################


While examining the Windows Defender Firewall, what is the LogAllowedConnections setting set to, for the Public profile?

********************************************************* SOLUTION ********************************************************

Got to windows start button and type windows Defender Firewall -> Advanced Settings -> Windows Defender Firewall Properties -> Specify Logging -> Log dropped packets set to no and Log successful connections set to NO. 

# tried this from powershell too->  Get-NetFirewallProfile 

# tried this from powershell too->   Get-NetFirewallProfile -Profile Public

######################################################### Windows_Hidden_Processes_7 10 #########################################################

A nonstandard port has been opened by possible malware on the system. Identify the port.

Machine: Workstation1 (RDP from Admin-Station)
login: student
password: password

********************************************************* SOLUTION ********************************************************

Standard are well known ports ---> ports between 0, 1023 or ports between 1024 to 49151


#Open tcpview sysinternal

#Notice that powershell.exe is listening on port 6666

#Powershell would use TCP/5985 = HTTP or TCP/5986 = HTTPS, so you know this one could be malware

6666

######################################################### Windows_Hidden_Processes_8 10 #########################################################

Determine what mechanism opened the port from hidden_processes_7. The flag is the name of the file.

Hint: The file is not legit.

Machine: Workstation1 (RDP from Admin-Station)
login: student
password: password

********************************************************* SOLUTION ********************************************************



 Run Task Scheduler as administrator

- On the right hand side “Display All Running Tasks”

- Notice GoogleUpdater current action is to run powershell ????

- Close and right click GoogleUpdater, Select properties

- Double click the actions, notice under arguments “-noexit -windowstyle hidden -File C:\windows\system32\legit_script.ps1”

legit_script.ps1


######################################################### Windows_File_System_Basics_13 15 #########################################################

Identify the flag from the file in hidden_processes_8.

********************************************************* SOLUTION ********************************************************

type legit_script.ps1 # see what the flag/comment is - > Th1s_1s_n0t_l3g1t



######################################################################################################################################################
######################################################                                             ###################################################
######################################################                  10_windows_uac             ###################################################
######################################################                                             ###################################################
######################################################################################################################################################


######################################################### Windows_File_System_Basics_13 15 #########################################################

What Sysinternals tool will allow you to view a file's manifest?

********************************************************* SOLUTION ********************************************************

sigcheck

######################################################### Windows_UAC_Basics_2 5 #########################################################

What is the RequestedExecutionLevel for an application to run with the same permissions as the process that started it?

********************************************************* SOLUTION ********************************************************

asInvoker

######################################################### Windows_UAC_Basics_3 5 #########################################################

What RequestedExecutionLevel will prompt the user for Administrator credentials if they're not a member of the Administrator's group?

********************************************************* SOLUTION ********************************************************

requireAdministrator

######################################################### Windows_UAC_Basics_5 5 #########################################################

What registry key holds UAC values?

********************************************************* SOLUTION ********************************************************

HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System

######################################################### Windows_UAC_Basics_4 10 #########################################################

The flag is the RequestedExecutionLevel of the schtasks.exe file.

********************************************************* SOLUTION ********************************************************

Get-ChildItem -Path C:\ -Recurse -Filter schtasks.exe -ErrorAction SilentlyContinue | Where-Object { !$_.PSIsContainer } # Find where the schtasks.exe is 

net use * http://live.sysinternals.com

z:

./sigcheck -m C:\Windows\System32\schtasks.exe # Scroll down to see the description... the answer is asInvoker

######################################################### Windows_UAC_Basics_6 10 #########################################################


Determine which UAC subkey property shows whether UAC is enabled or not. The flag is the data value in that property.

Hint: Make sure you're on the file-server.

********************************************************* SOLUTION ********************************************************

Once on file server

Powershell

Get-ChildItem HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies

Get the value for EnableLUA -> 9194

$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

Cd HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies

ls -force

SEE —-> EnableLUA : 4919

EnableLUA – Shows if UAC is enable or not 

######################################################### Windows_UAC_Basics_7 10 #########################################################

Provide the name of the UAC [Registry subkey] property that determines what level UAC is set to for admin privileges (Example UAC levels: Default, Always, Notify).

********************************************************* SOLUTION ********************************************************


- Once on file server

Powershell

Get-ChildItem HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies

under system the answer should be ConsentPromptBehaviorAdmin

$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

1. Cd HKLM

2. Cd SOFTWARE\Microsoft\Windows\CurrentVersion\Policies

3. Ls -force ###to see the files/output

4. SEE —->ConsentPromptBehaviorAdmin (answ)

5 #this level of UAC is set to Default, Always, Notify

######################################################### Windows_UAC_Basics_8 10 #########################################################

Query the registry subkey where UAC settings are stored, and provide the flag.

********************************************************* SOLUTION ********************************************************



Once on file server

Powershell


Get-ChildItem HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies

under system the flag should be GoodJob

$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

Cd HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies

- this is where UAC setting are stored

ls -force 

######################################################################################################################################################
######################################################                                             ###################################################
######################################################            Windows UAC Basics 8             ###################################################
######################################################                                             ###################################################
######################################################################################################################################################

######################################################### Windows_UAC_Basics_8 10 #########################################################

What command-line (cmd) command will show service information?

********************************************************* SOLUTION ********************************************************

sc.exe

######################################################### Windows_Services_Basics_2 5  #########################################################

What command-line (cmd) command will show all services, running or not running?

The flag is the full command, for all services.

********************************************************* SOLUTION ********************************************************

sc queryex type=service state=all

######################################################### Windows_Services_Basics_3 5 #########################################################

What PowerShell command will list all services?

********************************************************* SOLUTION ********************************************************

Get-service

######################################################### Windows_Services_Basics_4 5 #########################################################

What registry location holds all service data?

********************************************************* SOLUTION ********************************************************

HKLM\SYSTEM\CurrentControlSet\Services

######################################################### Windows_Services_Basics_5 5 #########################################################

What registry subkey holds a service's .dll location?

The flag is the subkey name (full path not needed).

********************************************************* SOLUTION ********************************************************

HKLM\SYSTEM\CurrentControlSet\Services\<NAME>\Parameters

######################################################### Windows_Services_Basics_6 10 #########################################################

Services have a name and display name, which could be different. What is the service name of the only Totally-Legit service?

Reminder: All challenges are done using the file-server.

********************************************************* SOLUTION ********************************************************

ssh to the file-server

Get-service “Totally-Legit”

Name is Legit 

######################################################### Windows_Services_Basics_7 10 #########################################################


Figure out the SID of the only Totally-Legit service.

Example: S-1-5-80-159957745-2084983471-2137709666-960844832-[1182961511]

Submit only the [bracketed] portion of the SID.

HINT: Run the command on the service name, not the display name.

********************************************************* SOLUTION ********************************************************

sc.exe showsid “Legit” 

1182961511


######################################################################################################################################################
######################################################                                             ###################################################
######################################################                  10_windows_uac             ###################################################
######################################################                                             ###################################################
######################################################################################################################################################


######################################################### Primer_Networking_1 1 #########################################################

What is used in Windows to implement the networking stack to enable communication with the four lowest OSI layers?

Research: https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc958797(v=technet.10)?redirectedfrom=MSDN

********************************************************* SOLUTION ********************************************************

NDIS

######################################################### Primer_Networking_2 1 #########################################################

What Windows cmd.exe command will display the local computer's routing table?

Research: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/netstat


********************************************************* SOLUTION ********************************************************

route print

######################################################### Primer_Networking_3 1 #########################################################

IANA assigned TCP/UDP ports in the range of 0-1023 that are usually associated with server-side services are known as?

Research: https://networkencyclopedia.com/well-known-port-numbers/

********************************************************* SOLUTION ********************************************************

well-known ports

######################################################### Primer_Networking_4 1 #########################################################

What term describes randomly assigned TCP/UDP ports above 1023 and are used for a short period of time (for the duration of a communication session}?

Research: https://en.wikipedia.org/wiki/Ephemeral_port

********************************************************* SOLUTION ********************************************************

ephemeral ports

######################################################### Primer_Networking_5 1 #########################################################

The two words that decribe translating Host names to IP addresses or NetBIOS names to IP addresses is_____?

Research: https://learn.microsoft.com/en-us/windows/win32/dns/name-resolution

********************************************************* SOLUTION ********************************************************

Name Resolution

######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************



######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************




######################################################### Primer_Surveys_3 1 #########################################################

What type of survey is focused on malware detection, artifact detection and investigating processes?

Research: https://learn.microsoft.com/en-us/security/compass/incident-response-overview

********************************************************* SOLUTION ********************************************************

Incident Response

######################################################### Windows_Browser_Artifacts_1 5 #########################################################

What Sysinternals tool will allow you to read the SQLite3 database containing the web history of chrome?

********************************************************* SOLUTION ********************************************************

Strings

######################################################### Windows_Recent_Files_1 5 #########################################################

What is the registry location of recent docs for the current user?

********************************************************* SOLUTION ********************************************************

HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs


######################################################### Windows_Bam_1 5 #########################################################


Challenge only allows ONE attempt

BAM settings are stored in different registry locations based on the version of Windows 10. What version of Windows 10 is workstation2 running? The answer is the 4 digit Windows 10 release (version) number.

********************************************************* SOLUTION ********************************************************

Get-ComputerInfo | select WindowsProductName, WindowsVersion, OsHardwareAbstractionLayer

1803 

######################################################### Windows_Last_Access 5 #########################################################

Figure out the last access time of the hosts file.

Flag format: mm/dd/yyyy

********************************************************* SOLUTION ********************************************************

Get-Childitem "C:\users\$env:username\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt" | select LastAccessTime


######################################################### Windows_Prefetch_1 5 #########################################################

What is the literal path of the prefetch directory?

********************************************************* SOLUTION ********************************************************

C:\Windows\Prefetch

######################################################### Windows_Recycle_Bin_1 5 #########################################################

In the Recycle Bin, there is a file that contains the actual contents of the recycled file. What are the first two characters of this filename?

********************************************************* SOLUTION ********************************************************

To see the content of the recycled folder

PS C:\> Get-Childitem 'C:\$RECYCLE.BIN' -Recurse -Verbose -Force | select FullName

Here, $R – gives the content of the deleted file

$I – gives the location of the file

Ans: $R 


######################################################### Windows_Recycle_Bin_2 5 #########################################################

In the Recycle Bin, there is a file that contains the original filename, path, file size, and when the file was deleted. What are the first two characters of this filename?

********************************************************* SOLUTION ********************************************************

ANS -> $I

The Recycle Bin on Windows systems uses metadata files to store information about deleted items. When a file is deleted, Windows stores information about the file in a hidden system folder named $Recycle.Bin. Each deleted file or folder is represented by a pair of files in the Recycle Bin:

    A metadata file that holds the original file name, original path, file size, and the date and time the file was deleted. This file has a name in the format $I<uniqueID>.
        The actual file itself, renamed to a unique ID that corresponds with the metadata file, with a name in the format $R<uniqueID>.

The $I files are INFO2 or $I###### files (where ###### is a placeholder for the unique ID) that contain the details you mentioned. Therefore, the first two characters of the filenames you're asking about are $I.

Please note that this information is valid for Windows systems, and the actual file structure and naming conventions may vary between different versions of Windows. Additionally, this information is correct as of the last update I have until April 2023, and it's also important to be aware that accessing the $Recycle.Bin folder typically requires administrative privileges.

    Navigate to the $Recycle.Bin folder at the root of each drive.
    Open the $Recycle.Bin folder, which contains subfolders named after the SID (Security Identifier) of each user who has deleted files.
    Inside these subfolders are the $I and $R files corresponding to each deleted item.

To programmatically access these files and read their contents, you would generally use specialized software or write a script to parse the data. It's important to handle this information with care, as improper access or modification could potentially cause issues with the operating system.


######################################################### Windows_UserAssist_1 5 #########################################################

What are the first 8 characters of the Globally Unique Identifier (GUID) used to list applications found in the UserAssist registry key (Windows 7 and later)?

********************************************************* SOLUTION ********************************************************

https://os.cybbh.io/public/os/latest/011_windows_auditing_&_logging/artifacts_fg.html#_5_prefetch
CEBFF5CD

######################################################### Windows_UserAssist_2 5 #########################################################

What cipher method are UserAssist files encoded in?

********************************************************* SOLUTION ********************************************************

They are located in HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{GUID}\Count\ * they are encoded in ROT13
https://os.cybbh.io/public/os/latest/011_windows_auditing_&_logging/artifacts_fg.html#_5_prefetch

######################################################### Windows_Logs_1 5 #########################################################

What main Windows log would show invalid login attempts?

********************************************************* SOLUTION ********************************************************

Security

######################################################### Windows_Logs_2 5 #########################################################

What main Windows log will show whether Windows updates were applied recently?

********************************************************* SOLUTION ********************************************************

System

######################################################### Windows_Logs_3 5 #########################################################

When reading logs, you may notice ... at the end of the line where the message is truncated. What format-table switch/argument will display the entire output?

Flag format: -argument

********************************************************* SOLUTION ********************************************************

-wrap

######################################################### Windows_Browser_Artifacts_2 10 #########################################################

Find the questionable website that a user browsed to (using Chrome), that appears to be malicious. *Note: There are more than one users on the box.

Machine: Workstation2 (ssh from Admin_Station)

********************************************************* SOLUTION ********************************************************

 Use this command to look for recent broweser hsitory and juts URL’s:

$History| Select-String -Pattern "(https|http):\/\/[a-zA-Z_0-9]+\.\w+[\.]?\w+" -AllMatches|foreach {$_.Matches.Groups[0].Value}| ft Anw: https://www.exploitdb.com

Or

Get-Content 'C:\users\student\AppData\Local\Google\Chrome\User Data\Default\History' https://www.exploit-db.com/ 

######################################################### Windows_Recent_Files_2 10 #########################################################

There is a file that was recently opened that may contain PII.

Get the flag from the contents of the file.

Hint: We're not interested in numbers.

********************************************************* SOLUTION ********************************************************

 Get-Item 'Registry::\HKEY_USERS\*\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.*' 

  Get-Item "REGISTRY::HKEY_USERS\*\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.txt" | select -Expand property | ForEach-Object {
>>
>> [System.Text.Encoding]::Default.GetString((Get-ItemProperty -Path "REGISTRY::HKEY_USERS\*\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.txt" -Name $_).$_)} # Get location for txt file 

ANS --> Flag, Find A.


((((((((((((((((((((((((((((((((((()))))))))))))))))))))))))))))))))))

Get-Item 'Registry::\HKEY_USERS\*\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.*'

We see the txt file was opened now to see where is the location of this file

Get-Item "REGISTRY::HKEY_USERS\*\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.txt" | select -Expand property | ForEach-Object {

[System.Text.Encoding]::Default.GetString((Get-ItemProperty -Path "REGISTRY::HKEY_USERS\*\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.txt" -Name $_).$_)}

C:\Users\student\Documents\3-14-24.txt

This gives us the location: Directory: C:\Users\student\Documents

Now change directory and rread the .txt file: PS C:\Users\student\Documents> Get-Content "3-14-24.txt"

Answ: Flag, Found A.

OR

Get-Item "REGISTRY::HKEY_USERS\\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.txt" | select -Expand property | ForEach-Object {[System.Text.Encoding]::Default.GetString((Get-ItemProperty -Path "REGISTRY::HKEY_USERS\\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.txt" -Name $).$)}

#returns the path of the file you need

cd C:\Users\student\Documents

ls

get-content 3-14-24.txt

Flag: Flag, Found A.


######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************




######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************




######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************





######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************



######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************




######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************




######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************




######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************


######################################################################################################################################################
######################################################                                             ###################################################
######################################################              15_memory_analysis             ###################################################
######################################################                                             ###################################################
######################################################################################################################################################


######################################################### Primer_Networking_1 1 #########################################################

What is used in Windows to implement the networking stack to enable communication with the four lowest OSI layers?

Research: https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc958797(v=technet.10)?redirectedfrom=MSDN

********************************************************* SOLUTION ********************************************************

NDIS

######################################################### Primer_Networking_2 1 #########################################################

What Windows cmd.exe command will display the local computer's routing table?

Research: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/netstat


********************************************************* SOLUTION ********************************************************

route print

######################################################### Primer_Networking_3 1 #########################################################

IANA assigned TCP/UDP ports in the range of 0-1023 that are usually associated with server-side services are known as?

Research: https://networkencyclopedia.com/well-known-port-numbers/

********************************************************* SOLUTION ********************************************************

well-known ports

######################################################### Primer_Networking_4 1 #########################################################

What term describes randomly assigned TCP/UDP ports above 1023 and are used for a short period of time (for the duration of a communication session}?

Research: https://en.wikipedia.org/wiki/Ephemeral_port

********************************************************* SOLUTION ********************************************************

ephemeral ports

######################################################### Primer_Networking_5 1 #########################################################

The two words that decribe translating Host names to IP addresses or NetBIOS names to IP addresses is_____?

Research: https://learn.microsoft.com/en-us/windows/win32/dns/name-resolution

********************************************************* SOLUTION ********************************************************

Name Resolution


######################################################### Primer_Networking_6 1 #########################################################

What is the hierarchical service/protocol that translates hostnames to IP addresses?

Research: https://learn.microsoft.com/en-us/windows/win32/dns/dns-overview

********************************************************* SOLUTION ********************************************************

DNS

######################################################### Primer_Security_1 1 #########################################################

What is the term for the numeric value that the Windows OS uses to uniquely ID a user, group or computer?


********************************************************* SOLUTION ********************************************************

SID

######################################################### Primer_Security_2 1 #########################################################

What switch can be added to the CMD.exe command whoami, to view the SID of the current user?

Research: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/whoami

********************************************************* SOLUTION ********************************************************

/user

######################################################### Primer_Security_3 1 #########################################################

What is the value of a Relative Identifier (RID) assigned to the 1st user account?

https://os.cybbh.io/public/os/latest/013_memory_analysis/primer.html#_4_associate_a_user_sid_with_a_user_profile

********************************************************* SOLUTION ********************************************************

1000

######################################################### Primer_Security_4 1 #########################################################

What is the well known RID for the Windows Built-In Administrator Local account?

Research: https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-dtyp/81d92bba-d22b-4a8c-908a-554ab29148ab

********************************************************* SOLUTION ********************************************************



######################################################### Primer_Security_5 1 #########################################################

Complete the GET_CimInstance cmdlet to view all the user SIDs on a Windows host machine by Name and SID respectively:

Get-CimInstance Win32_UserAccount | Select-Obect ______________

**hint: the output will ONLY include Name and SID

********************************************************* SOLUTION ********************************************************

Name, SID


######################################################### Primer_Security_6 1 #########################################################

In Windows what else does a user's security Token contain?

SIDS of groups of which the user is a member
Privilege array
The Users _________ ?
**hint: Flag describes the unique number assigned to the user

Research: https://os.cybbh.io/public/os/latest/013_memory_analysis/primer.html#_1_1_security_identifiers_sids


********************************************************* SOLUTION ********************************************************

SID

######################################################### Primer_Security_7 1 #########################################################

When contained in a Windows users access token, what privilege does SeBackupPrivilege grant to the user to perform on files and folders?

**hint - flag is one word

Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/ifs/privileges


********************************************************* SOLUTION ********************************************************

Backup

######################################################### Primer_Security_8 1 #########################################################

Windows performs mandatory integrity checks (MICs) by comparing the integrity level of the resource with the integrity level of the calling process. Windows does this integrity check before the the objects discretionary access check because it is _____________?

Research: https://learn.microsoft.com/en-us/windows/win32/secauthz/mandatory-integrity-control

Hint: Opposite of slower


********************************************************* SOLUTION ********************************************************

faster

######################################################### Primer_Security_9 1 #########################################################

A Windows object's Security _________ contains:

The SID of the object's owner
Discretionary Access Control List (DACL)
System Access Control List (SACL)
Research: https://learn.microsoft.com/en-us/windows/win32/secauthz/security-descriptors

********************************************************* SOLUTION ********************************************************

Descriptor

######################################################### Primer_Security_10 1 #########################################################

What contains Access Control Entries (ACEs), that define the types of access a user or group may be granted to an object?

Research: https://learn.microsoft.com/en-us/windows/win32/secauthz/access-control-lists


********************************************************* SOLUTION ********************************************************

DACL

######################################################### Primer_Security_11 1 #########################################################

What cmdlet gets objects that represent the security descriptor of a file or resource?

Research: https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.security/get-acl?view=powershell-7.2

********************************************************* SOLUTION ********************************************************

Get-Acl

######################################################### Primer_Security_12 1 #########################################################

What NET cmd.exe command can be used to enumerate the local Windows group accounts?

Research: https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc725622(v=ws.11)

********************************************************* SOLUTION ********************************************************

net localgroup

######################################################### Primer_Security_13 1 #########################################################

Read and answer

https://ss64.com/nt/icacls.html

What Windows cmd.exe command will display or modify Access Control Lists (ACLs) for files and folders and resolves various issues that occur when using the older CACLS & XCACLS.

********************************************************* SOLUTION ********************************************************

ICACLS

######################################################### Primer_Security_14 1 #########################################################

Read and answer:

https://learn.microsoft.com/en-us/windows/win32/memory/data-execution-prevention

What Windows security feature is a system-level memory protection feature that is built into the operating system starting with Windows XP and Windows Server 2003 and enables the system to mark one or more pages of memory as non-executable?

********************************************************* SOLUTION ********************************************************

DEP

######################################################### Primer_Security_15 1 #########################################################

What computer security technique is used in Windows to prevent exploitation of memory corruption vulnerabilities? This feature randomly arranges the address space positions of key data areas of a process, in order to prevent an attacker from reliably jumping to, a particular exploited function in memory.

Research: https://www.mandiant.com/resources/blog/six-facts-about-address-space-layout-randomization-on-windows

********************************************************* SOLUTION ********************************************************

ASLR

######################################################### Primer_Security_16 1 #########################################################

What is a small kernel-mode library that can implement API hooking?

Research: https://techcommunity.microsoft.com/t5/ask-the-performance-team/demystifying-shims-or-using-the-app-compat-toolkit-to-make-your/ba-p/374947

********************************************************* SOLUTION ********************************************************

Shim

######################################################### Primer_Security_17 1 #########################################################

Read and Answer the next 4 challenges regarding Windows security features introduced in Windows 10 Creator's Update (Windows 10, version 1703)

https://learn.microsoft.com/en-us/windows/security/threat-protection/overview-of-threat-mitigations-in-windows-10

Which security feature helps keep attackers from gaining access through Pass-the-Hash or Pass-the-Ticket attacks using virtualization-based security to isolate secrets, such as NTLM password hashes and Kerberos Ticket Granting Tickets?

********************************************************* SOLUTION ********************************************************

Credential Guard

######################################################### Primer_Security_18 1 #########################################################

Introduced in Windows 8 this is Microsoft Antivirus, anti-malware solution?
Research: https://www.microsoft.com/en-us/windows/comprehensive-security

********************************************************* SOLUTION ********************************************************

Defender

######################################################### Primer_Security_19 1 #########################################################

What security technique helps prevent overwrites of the Structured Exception Handler?
Research: https://support.microsoft.com/en-us/topic/how-to-enable-structured-exception-handling-overwrite-protection-sehop-in-windows-operating-systems-8d4595f7-827f-72ee-8c34-fa8e0fe7b915

********************************************************* SOLUTION ********************************************************

SEHOP

######################################################### Primer_Security_20 1 #########################################################

What security protection is built into Windows 10, as described in the "Memory reservations" item in Kernel pool protections? This includes protecting address space 0x00000000 (not listed in article).
Hint: what is 0? Research: https://learn.microsoft.com/en-us/windows/win32/memory/reserving-and-committing-memory

********************************************************* SOLUTION ********************************************************

null page

######################################################### Primer_Security_21 1 #########################################################

Read and answer: https://learn.microsoft.com/en-us/windows/win32/wfp/windows-resource-protection-portal

What Windows security feature prevents the replacement of essential system files, folders, and registry keys that are installed as part of the operating system? It became available starting with Windows Server 2008 and Windows Vista.

********************************************************* SOLUTION ********************************************************

Windows Resource Protection

######################################################### Primer_Security_22 1 #########################################################

Read and answer: https://support.microsoft.com/en-us/topic/use-the-system-file-checker-tool-to-repair-missing-or-corrupted-system-files-79aa86cb-ca52-166a-92a3-966e85d4094e

What option should you use with the System File Checker cmd.exe tool sfc.exe to scan all protected system files, and replace corrupted files with a cached copy that is located in a compressed folder at %WinDir%\System32\dllcache ?

********************************************************* SOLUTION ********************************************************

/scannow

######################################################### Primer_Security_23 1 #########################################################

Where are copies of known-good critical system files located at %WinDir%___________ and used by the Windows Resource Protection feature?

hint: complete the path

Research: https://en.wikipedia.org/wiki/Windows_Resource_Protection https://learn.microsoft.com/en-us/windows-hardware/manufacture/desktop/clean-up-the-winsxs-folder?view=windows-11

********************************************************* SOLUTION ********************************************************

\WinSxS\Backup

######################################################### Primer_Networking_7 1 #########################################################

What CLI tool is often used to troubleshoot DNS issues but can also be used in reconnaissance?

Research: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/nslookup

********************************************************* SOLUTION ********************************************************

nslookup

######################################################### Primer_Networking_8 1 #########################################################

In Windows 10 what is the full path to the hosts file? Complete the path c:\Windows____________

Research: https://www.tenable.com/plugins/nessus/23910

********************************************************* SOLUTION ********************************************************

System32\drivers\etc\hosts

######################################################### Primer_Networking_9 1 #########################################################

Fill in the missing component for the usual Host Name Resolution order:

Client checks own host name
Client searches local Hosts file
______________________
NetBIOS name resolution sequence is used as a backup
Flag Format: Full name or acronym

Research: https://learn.microsoft.com/en-us/windows/win32/dns/dns-overview https://support.microsoft.com/en-us/topic/microsoft-tcp-ip-host-name-resolution-order-dae00cc9-7e9c-c0cc-8360-477b99cb978a


********************************************************* SOLUTION ********************************************************

Domain Name System (DNS) servers are queried.

######################################################### Primer_Networking_10 1 #########################################################

What cmd.exe tool will display NetBIOS transport statistics in Windows?

Research: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/nbtstat

********************************************************* SOLUTION ********************************************************

nbtstat

######################################################### Primer_Surveys_1 1 #########################################################

What team survey is focused on security and auditing?

______ Team

Research: https://www.coursera.org/articles/red-team-vs-blue-team


********************************************************* SOLUTION ********************************************************

Red

######################################################### Primer_Surveys_2 1 #########################################################

What type of survey is focused on computer system settings, updates, configurations and installed software?

________ Team

Research: https://ine.com/blog/understanding-blue-team-roles

********************************************************* SOLUTION ********************************************************

Blue

######################################################### Windows_Memory_Analysis_Plugin_1 5 #########################################################

What Volatility plugin will dump a process to an executable file sample?

********************************************************* SOLUTION ********************************************************

procdump

######################################################### Windows_Memory_Analysis_Plugin_2 5 #########################################################

What Volatility plugin will extract command history by scanning for _COMMAND_HISTORY?

********************************************************* SOLUTION ********************************************************

CmdScan

######################################################### Windows_Memory_Analysis_Plugin_3 5 #########################################################

What Volatility plugin will show driver objects?


********************************************************* SOLUTION ********************************************************

driverscan

######################################################### Windows_Memory_Analysis_Basics_2 5 #########################################################

What command do you run to find which memory profile to use with a memory image?


********************************************************* SOLUTION ********************************************************

imageinfo

######################################################### Windows_Memory_Analysis_Basics_1 5 #########################################################

What switch/argument will list all plugins for Volatility?

********************************************************* SOLUTION ********************************************************

-h

######################################################### Windows_Volatility_Data 5 #########################################################

In terms of Volatile Data, what locations are the MOST volatile?

Flag format: location,location

********************************************************* SOLUTION ********************************************************

CPU registers, cache

######################################################### Windows_Memory_Analysis_Basics_3 10 #########################################################

What is the 12th plugin listed in the Volatility help menu?

********************************************************* SOLUTION ********************************************************

cmdscan

######################################################### Windows_Memory_Analysis_Basics_4 10 #########################################################

What profile do you use in conjunction with this memory image?

Use the following file (memory image) to answer the rest of the Memory Analysis challenges.

0zapftis.vmem

********************************************************* SOLUTION ********************************************************

.\volatility_2.6_win64_standalone.exe -f ".\0zapftis.vmem" imageinfo

WinXPSP2x86

######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************

.\volatility_2.6_win64_standalone.exe -f ".\0zapftis.vmem" --profile=WinXPSP2x86 cmdscan

Cmd #1 @ 0x11135e8: sc query malware

Answer -> sc query malware

######################################################### Windows_Malware_2 10 #########################################################

What are the last 7 digits of the memory offset for the driver used by the malware?

********************************************************* SOLUTION ********************************************************

.\volatility_2.6_win64_standalone.exe -f ".\0zapftis.vmem" --profile=WinXPSP2x86 driverscan | findstr "malware"

Answer -> 1a498b8

######################################################### Windows_Malware_3 10 #########################################################

The process running under PID 544 seems malicious. What is the md5hash of the executable?

********************************************************* SOLUTION ********************************************************

# create a temporary folder called dump_folder before running this command
.\volatility_2.6_win64_standalone.exe -f ".\0zapftis.vmem" --profile=WinXPSP2x86 procdump -p 544 -D dump_folder 

#check the name of the executable under dump_folder before running generating the hash
certutil -hashfile dump_folder\executable.544.exe MD5


######################################################### Windows_Malware_4 10 #########################################################

What remote IP and port did the system connect to?

Flag format: ip:port

********************************************************* SOLUTION ********************************************************

.\volatility_2.6_win64_standalone.exe -f ".\0zapftis.vmem" --profile=WinXPSP2x86 connscan

Ans ->  172.16.98.1:6666






######################################################################################################################################################
######################################################                                             ###################################################
######################################################   16_windows_active_directory_enumeration   ###################################################
######################################################                                             ###################################################
######################################################################################################################################################


######################################################### Primer_Active_Directory_1 1 #########################################################

What is the database that is used to connect users with network resources?

Resources https://os.cybbh.io/public/os/latest/014_windows_active_directory_enumeration/primer.html

********************************************************* SOLUTION ********************************************************

Active Directory

######################################################### Primer_Active_Directory_2 1 #########################################################

What are all things that are in active directory stored as?

Resources https://os.cybbh.io/public/os/latest/014_windows_active_directory_enumeration/primer.html#_1_1_active_directory_structure

********************************************************* SOLUTION ********************************************************

objects

######################################################### Primer_Active_Directory_3 1 #########################################################

What is the Active Directory component which contains formal definitions of every object class that can be created in an Active Directory forest?

Resources https://os.cybbh.io/public/os/latest/014_windows_active_directory_enumeration/primer.html#_3_domains

********************************************************* SOLUTION ********************************************************

Schema

######################################################### Primer_Active_Directory_4 1 #########################################################

What protocol is used when accessing and updating the Active Directory?

Resources https://www.sciencedirect.com/topics/computer-science/directory-access-protocol

********************************************************* SOLUTION ********************************************************

LDAP

######################################################### Primer_Active_Directory_5 1 #########################################################

From an Offensive perspective, what type of account is usually the main target?

Resources https://os.cybbh.io/public/os/latest/014_windows_active_directory_enumeration/primer.html#_7_administrator_best_practices

********************************************************* SOLUTION ********************************************************

Administrator

######################################################### Primer_Active_Directory_6 1 #########################################################

Task : If an account has been inactive for a substantial amount of time what should the adminstrators do to the account?

Resources https://os.cybbh.io/public/os/latest/014_windows_active_directory_enumeration/primer.html#_11_impact_of_group_policy_settings


********************************************************* SOLUTION ********************************************************

Disable

######################################################### Primer_Active_Directory_7 1 #########################################################

What is the basic PowerShell cmdlet used to enumerate users?

Resources https://os.cybbh.io/public/os/latest/014_windows_active_directory_enumeration/primer.html#_2_2_powershell


********************************************************* SOLUTION ********************************************************

Get-ADUser

######################################################### Primer_Active_Directory_8 1 #########################################################

What is the suite of tools used in CLI to enumerate users across the network?

Resources https://os.cybbh.io/public/os/latest/014_windows_active_directory_enumeration/primer.html#_2_1_domain_service_ds_tools

********************************************************* SOLUTION ********************************************************

DS tools 

######################################################### Windows_Active_Directory_Basics_1 5 #########################################################

What is the domain portion of the following SID:

S-1-5-21-1004336348-1177238915-682003330-1000

********************************************************* SOLUTION ********************************************************

21-1004336348-1177238915-682003330

######################################################### Windows_Active_Directory_Basics_1 5 #########################################################

What PowerShell command will list domain groups?

********************************************************* SOLUTION ********************************************************

Get-ADGroup

######################################################### Windows_Active_Directory_Basics_2 5 #########################################################

What PowerShell command will list all users and their default properties?

The flag is the full command with arguments.

********************************************************* SOLUTION ********************************************************

Get-ADUser -Filter *

######################################################### Windows_Active_Directory_Basics_5 5 #########################################################

What PowerShell command will allow you to search Active Directory accounts for expired accounts without having to create a filter?

The flag is only the command, no arguments/switches.

********************************************************* SOLUTION ********************************************************

search-adaccount

######################################################### Windows_AD_Search_Accounts 10 #########################################################

Find the expired accounts that aren't disabled. List the last names in Alphabetical Order, separated with a comma, and no space between.

Flag format: name,name

Reminder: All challenges are done using the Domain-Controller

********************************************************* SOLUTION ********************************************************

search-adaccount -AccountExpired

- krause,page 

######################################################### Windows_AD_Search_Emails 10 #########################################################

Find the unprofessional email addresses. List the email's domain.

********************************************************* SOLUTION ********************************************************

Get-ADUser -Filter * -Properties emailaddress |select emailaddress

Get-ADUser -Filter * -Properties emailaddress | Where-Object { $_.emailaddress -notmatch '^[a-zA-Z]+\.[a-zA-Z]+\.mil@mail\.mil$' } | Select-Object emailaddress


Lewis.Hansen.mil@mail.mil

All the emails are mail.mil beside one which is ashleymadison.com ,just the email domain!

CharlieB@ashleymadison.com
Skyler01@ashleymadison.com

######################################################### Windows_AD_Search_Files 10 #########################################################

The flag is the unprofessionally-named file located somewhere on the Warrior Share.

Connect to the Warrior Share:

net use * "\\file-server\warrior share"

********************************************************* SOLUTION ********************************************************

 Connect to the Warrior Share: net use * "\\file-server\warrior share"

- to change the path to different drive: Set-Location -Path Z:/

- To get child items(folders/files) in current and all subdiretories of the Z drive

Get-ChildItem -path 'Z:\' -Recurse –Force 

Here, path ‘Z:\’ can be replaced with other drives or if we want to search for only pdf we can do ‘Z:\*.pdf’

After looking through all directory we see a file called

Lulz.pdf which seems unprofessional

https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-childitem?view=powershell-7.2

######################################################### Windows_AD_Search_Insider_2 10 #########################################################

The flag is the name of the user who is requesting modified access rights.

Connect to the Warrior Share:

net use * "\\file-server\warrior share"

Hint: Complete Windows_AD_Search_Insider_1 first.

********************************************************* SOLUTION ********************************************************

After connecting to the fileserver, we look through the directories, we know S6 handles all the access request so we go to brigade folder throught file path: \\file-server\warrior share\Brigade HQ\S-6 in file explored

Open the 14287 file using file explorer -> enter \\file-server\warrior share\Brigade HQ\S-6 to the file path... 
- We find pdf 14287.pdf, after opening this we see –K as the initial. Need to find the full name. To find full name we know tis email was regarding printer issues so lets see all the groups in this directory:

- Get-ADGroup -Filter * #Lists all the groups

- Get-ADgroupMember –Identity ‘Print Server Group’ -recursive #To see all the mmbers of this group

- To get the names and phonenumbers:

- Get-ADGroupMember -Identity 'Print Server Group' -recursive | select name, telephoneNumbers

- We find only one name with the name that has K

Karen,Nance

######################################################### Windows_AD_Search_Insider_1 10 #########################################################

The flag is the name of the file where someone is requesting modified access rights.

Connect to the Warrior Share:

net use * "\\file-server\warrior share"

********************************************************* SOLUTION ********************************************************

14287.pdf

######################################################### Windows_AD_Search_Naming 10 #########################################################

Find the accounts that contain unprofessional information in the description.

List the last names in Alphabetical Order, separated by a comma, with no space.

Flag format: name,name

********************************************************* SOLUTION ********************************************************

- To get the names of all the users along with description

get-aduser -filter * -Properties Description | select name, description


Alice.Brandywine    <=========|%%%%> Brigade S-6 Automations NCO <%%%%|=========>
Krystal.Jimenez     <------<< Brigade S-1 ACTIONS NCOIC |_|> >>------>

Brandywine,Jimenez

######################################################### Windows_AD_Search_Passwords 10 #########################################################


Find the following three accounts:

two accounts with passwords that never expire
one account that has its password stored using reversible encryption
List the last names in Alphabetical Order, comma-separated, no spaces. Do not list built-in accounts.

Flag format: name,name,name



********************************************************* SOLUTION ********************************************************

First look for the properties which you can use to filter through. The command to look for all the properties is:

Get-ADUser -filter * -Properties *

- After looking at all the properties we can see that properties we need is AllowReversiblePasswordEncryption and passwordneverexpires

- Now using these properties to find the answer # Filter using these properties and asking to give values if this property is set to true,We know not to use the built-in account


- Get-ADUser -filter 'passwordneverexpires -eq "true"'

- Get-ADUser -filter 'AllowReversiblePasswordEncryption -eq "true"'

Xavier.Ibarra -> passwordneverexpires
Eddie.Sanchez -> passwordneverexpires

Alice.Brandywine -> AllowReversiblePasswordEncryption

Brandywine,Ibarra,Sanchez

######################################################### Windows_AD_Search_PII 10 #########################################################

The flag is the name of the file containing PII on the Warrior Share.

Connect to the Warrior Share:

net use * "\\file-server\warrior share"

********************************************************* SOLUTION ********************************************************

to view all the files in directories and sub-directories:

Get-ChildItem -path 'Z:\' -Recurse –Force

Going through the files we can see phone_matrix.xlsx 

######################################################### Windows_Active_Directory_Basics_6 10 #########################################################

Find the short name of the domain in which this server is a part of.

********************************************************* SOLUTION ********************************************************

To find the name of the domain:

Get-WmiObject -Class win32_NTDomain

Ans: ARMY 

######################################################### Windows_Active_Directory_Basics_7 10 #########################################################


What is the RID of the krbtgt account.

Example: S-1-5-21-1004336348-1177238915-682003330-[501]


********************************************************* SOLUTION ********************************************************

Example: S-1-5-21-1004336348-1177238915-682003330-[501]

To filter the name “krbtgt” use the command:

get-aduser -filter 'Name -like "krbtgt"'

answer: 502 

######################################################### Windows_Active_Directory_Basics_3 10 #########################################################


How many users are members of the Domain Admins group?

HINT: No sub-groups.

********************************************************* SOLUTION ********************************************************
(Get-ADGroup "Domain Admins" -Properties *).Member.Count # There's a 1 level so subtract 1 you remain with 1. 

Get-ADGroupMember -Identity "domain admins"

asnw#1 

######################################################### Windows_Active_Directory_Basics_4 10 #########################################################

How many total users are members of the Domain Admins group?

********************************************************* SOLUTION ********************************************************

to get the number of people in Domain Admin group

Get-ADGroupMember -Identity 'Domain Admins' -Recursive

Now, to count

(Get-ADGroupMember -Identity 'Domain Admins' -Recursive).count

- 14 

######################################################### Windows_AD_Follow_Insider_Trail_1 15 #########################################################


Continue to follow the insider trail to find additional insider threats and their compromised mission.

The flag is the full name of the next insider threat identified.

HINT: Search the Active Directory record of the user identified in search_insider_2.

********************************************************* SOLUTION ********************************************************

Get-ADUser karen.nance -Properties *

Here, we see street address looks weird:

rkcrpg zl arkg pbzzhavpngvba ng 06:30 uef gbzbeebj zbeavat. Ybpngvba sbe qrgnvyf v aibyivat n uvtuyl pynffvsvrq bcrengvba hcybnqrq gb Gvssnal

rkcrpg zl arkg pbzzhavpngvba ng 06:30 uef gbzbeebj zbeavat. Ybpngvba sbe qrgnvyf vaibyivat n uvtuyl pynffvsvrq bcrengvba hcybnqrq gb Gvssnal . .

Now, using ROT13 to decipher we get message: expect my next communication at 06:30 hrs tomorrow morning. Location for details involving a highly classified operation uploaded to Tiffany

Now, we know tiffany is another user. To get more details of Tiffany:

Get-ADUser -filter "name -like 'Tiffany*'"

Tiffany.Bellacino

######################################################### Windows_AD_Follow_Insider_Trail_2 15 #########################################################

Continue to follow the insider trail to find additional insider threats and their compromised mission.

The flag is the username resulting from assembling clues within a user's records.

HINT: Search the Active Directory record of the user identified in follow_insider_trail_1. Piece together clues to identify another insider threat.

********************************************************* SOLUTION ********************************************************

To get more details on Tiffany:

Get-ADUser -filter "name -like 'Tiffany*'"-Properties * (DS) Tools
The flag is the full name of the insider threat identified.

HINT: Search the Active Directory record for the user identified in follow_insider_trail_2.

********************************************************* SOLUTION ********************************************************

Trying to get more information on Damian

- Get-ADUser -filter "name -like '*Damian*'" -Properties *

Here on the Info Section, we can see a note from Isiah. So, let find more information of Isiah

P0P SECRET - Star Wars Rogue One, opening night tomorrow!  Get em before they sell out! -Isiah

Get-ADUser -Filter "name -like '*Isiah*'"

Isiah.Jesus

######################################################### Windows_AD_Follow_Insider_Trail_4 15 #########################################################

Continue to follow the insider trail to find additional insider threats and their compromised mission. This flag is a video link.

Hint: Search the Active Directory record for the user identified in follow_insider_trail_3.

********************************************************* SOLUTION ********************************************************


Get-ADUser -filter "name -like '*Isiah*'"-Properties *
















Here, street address has some funky numbers: aHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj1kUXc0dzlXZ1hjUQ== Converting this
https://www.youtube.com/watch?v=dQw4w9WgXcQ

is from base64 it will give us: 











