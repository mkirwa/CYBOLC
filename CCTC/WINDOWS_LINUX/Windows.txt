######################################################### Primer_Boot_Process_9 1 #########################################################

What is the name of the process that spawns SYSTEM?

Research: https://en.wikipedia.org/wiki/Windows_NT_booting_process (Hint: What really is SYSTEM?)


********************************************************* SOLUTION ********************************************************

ntoskrnl.exe


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^/////////////////  POWERSHELL NOTES   /////////////////^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

PowerShell-Link Notes -> https://os.cybbh.io/public/os/latest/002_powershell/pwsh_fg.html

PS C:\> get-host | select-object Version # Gets the version of powershell in use

PS C:\> pwsh # Changes version 

PS C:\> exit # Switch back to previous version

Get-Content -Path "C:\Test Files\content.txt"                                         # Displays the contents of the file
Get-Variable                                                                          # Displays current Variables
Get-Verb                                                                              # List the PowerShell verbs
Get-Command                                                                           # List the PowerShell cmdlets
Get-Command -Type Cmdlet | Sort-Object -Property Noun | Format-Table -GroupBy Noun    # Get cmdlets and display them in order
Get-Command -Module Microsoft.PowerShell.Security, Microsoft.PowerShell.Utility       # Get commands in a module
Get-Location <similar to PWD on Linux, gl is the alias.>          # Displays present working directory

Get-Process | Get-Member                       # Gives the methods and properties of the object/cmdlet
(cmdlet).property                              # Command Structure
(Get-Process).Name                             # Returns the single property of 'name' of every process
Get-Process | Select-Object Name, ID, path     # Displays the Get-Process Properties of 'Name, ID, Path' for every process

##
Get-Process retrieves a list of all processes currently running on the system.
Select-Object Name, ID, Path filters the output to show only the process name, its ID, and the file path of the executable that started the process.
The output will be a table listing these properties for each process. If the process was started by the system and doesn't have an executable path, the 'Path' field for that process will be empty.
##

Get-Process | Select-Object Name, CPU, StartTime # For example, if you want to display the process name, CPU usage, and start time, your command would be:
Get-Process | Get-Member | Where-Object {$_.Membertype -match "Method"}       # Displays all objects with Method in their name from the results from Get-Member of the Get-Process cmdlet
Get-LocalUser | Get-Member      # Displays Properties and Methods of Get-LocalUser cmdlet

Get-Cimclass *                                                                  # Lists all CIM Classes
Get-CimInstance –Namespace root\securitycenter2 –ClassName antispywareproduct   # Lists the antispywareproduct class from the root/security instance
Get-CimInstance -ClassName Win32_LogicalDisk -Filter “DriveType=3” | gm         # Shows properties and methods for this Instance
Get-WmiObject -Class Win32_LogicalDisk -Filter “DriveType=3”                    # Using the Windows Management Instrumentation method

Get-CimInstance -class Win32_BIOS                      # Queries Win32_Bios
Get-WmiObject -Class Win32_BIOS                        # same output but deprecated command

##
Get-CimInstance -ClassName Win32_LogicalDisk -Filter “DriveType=3”: This part of the command retrieves instances of the Win32_LogicalDisk class (representing the logical disks on the computer) filtered where the DriveType equals 3.
In this context, DriveType=3 refers to local hard disk drives.
| gm (which is shorthand for | Get-Member): This pipes the output of the first command into Get-Member, which displays the properties and methods of the objects returned by the Get-CimInstance cmdlet.
##

## Powershell example do while loop ## 


C:\PS> $x = 1,2,78,0                        # Initializes an array $x with the elements 1, 2, 78, 0.
C:\PS> $count = 0                           # Sets two variables, $count and $a, to 0.
C:\PS> $a = 0                               # Sets two variables, $count and $a, to 0.
C:\PS> do { Write-Host "----------";        # Enters a do-while loop. In each iteration, it:   # Prints a separator line ("----------")
Write-Host "Count = $count";                # Prints the current value of $count.
Write-Host "a = $a";                        # Prints the current value of $a.
Write-Host "x =",$x[$a];                    # Prints the current element of the $x array indexed by $a.
$count++; $a++; } until ($x[$a] -eq 0)      # Increments $count and $a by 1. The loop continues as long as the element of $x at the current index $a is not equal to 0.
----------
Count = 0
a = 0
x = 1
----------
Count = 1
a = 1
x = 2
----------
Count = 2
a = 2
x = 78

## Powershell example for loop ## 
for (<Init>; <Condition>; <Repeat>)
{
    <Statement list>
}

$array = ("item1", "item2", "item3")
for($i = 0; $i -lt $array.length; $i++){ $array[$i] }
item1
item2
item3

$letterArray = "a","b","c","d"
foreach ($letter in $letterArray)
{
  Write-Host $letter
}

# Iterates through the list of items that is returned by the Get-ChildItem cmdlet

foreach ($file in Get-ChildItem)
{
  Write-Host $file
}

foreach ($i in Get-Alias) { Write-Host $i.name }

Remove-Item does_not_exist.txt -ErrorAction SilentlyContinue           # Hides any errors

$Processes = Get-Process          # Creates a Variable with the results of Get-Process
$Today = (Get-Date).DateTime      # Creates a combined Date/Time variable from the results of Get-Date

$a = 0..9
$i=0
while($i -lt 4) {
  $a[$i];
  $i++
}
#output
0
1
2
3

Get-Help about_Functions                                      # Displays the help about Functions
Get-Help about_Functions_Advanced                             # Displays some more in-depth help about Functions
Function Do-Stuff { Get-Date; Get-Process; Get-Service }      # Creates a Function with 'Get-Date, Get-Process, Get-Service' inside of it
Do-Stuff                                                      # Runs the Function

Get-ExecutionPolicy -list                                             # Lists all of the Scopes and ExecutionPolicies on the system
Get-ExecutionPolicy                                                   # Gets the current user's ExecutionPolicy
Set-ExecutionPolicy -ExecutionPolicy Unrestricted -Scope CurrentUser  # Sets the ExecutionPolicy for the CurrentUser to Unrestricted

Operator	Description
-lt         less than
-le         Less than or equal to
-gt         Greater than
-ge         Greater than or equal to
-eq         Equal to
-ne         Not equal to
-like       Like (uses wildcard for pattern matching)
-match      A match using Regular Expressions

get-help about_comparison_operators
Get-Service | Where-Object {$_.Status -eq "Stopped"}            # Takes the output from Get-Service and looks for Status property of Stopped and list those Services
Get-Service | where Status -eq "Stopped"                        # Same as above
Get-Process | Where-Object -Property Handles -GE -Value 1000    # Lists Processes that have Greater Than 1000 Handles
Get-Process | where Handles -GE 1000                            # Same as above

# Check profiles -> https://os.cybbh.io/public/os/latest/002_powershell/pwsh_fg.html

$profile | Get-Member -Type NoteProperty                        # Displays the profile values of Names, MemberType, and Paths.
$Profile | get-member -type noteproperty | ft -wrap             # Displays the same results but completed in case it was cut off '...'
$PROFILE | Get-Member -MemberType noteproperty | select name    # Narrowed results to display only Names

# To determines whether individual profiles have been created on the local computer:
Test-Path -Path $profile.currentUsercurrentHost
Test-Path -Path $profile.currentUserAllHosts
Test-Path -Path $profile.AllUsersAllHosts
Test-Path -Path $profile.AllUserscurrentHost

New-Item -ItemType File -Path $profile -Force                 # Creates a $Profile for the CurrentUser. Force is used to ignore any errors.
ISE $profile                                                  # Opens your newly created $Profile, which is empty

Get-ChildItem 'HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Profiles'   # Queries current network profiles.

HKLM (HKEY_LOCAL_MACHINE): This hive contains settings that are specific to the local computer. 
It includes system-wide configurations and is used to store information about the system's hardware and software. The settings in HKLM apply to all users on the machine.

HKCU (HKEY_CURRENT_USER): This hive contains configuration information for the user profile of the user currently logged on.
The settings in HKCU are specific to the current user and include user preferences and environment settings.

######################################################################################################################################################
######################################################                                             ###################################################
######################################################               09_windows_powershell         ####################################################
######################################################                                             ###################################################
######################################################################################################################################################


######################################################### Windows_PowerShell_Regex_3 10 #########################################################

Count the number of words, case-insensitive, with either a or z in a word, in the words.txt file
Note: File Location - C:\Users\CTF\Desktop\CTF

********************************************************* SOLUTION *********************************************************

cd C:\Users\CTF\Desktop\CTF
(Get-Content -Path .\words.txt | Where-Object { $_ -imatch 'a' -or $_ -imatch 'z' }).Count

######################################################### Windows_PowerShell_CimClasses2 10 #########################################################

To complete this challenge, find the description of the Lego Land service.

Reminder: All challenges are done using the file-server.

********************************************************* SOLUTION *********************************************************

$serviceName = Get-Service | Where-Object {$_.DisplayName -like "*Lego Land*" }
$LegoLandDescription = Get-Service | Where-Object {$_.DisplayName -like "*Lego Land*" }

Get-CimInstance -ClassName Win32_Service -Filter "Name='$($serviceName.Name)'" | Select-Object Description
Get-CimInstance -ClassName Win32_Service -Filter "Name='$($LegoLandDescription.Name)'" | Select-Object Description


######################################################### Windows_PowerShell_Logic5 10 #########################################################

Find the only line that makes the two files in the CTF user's Downloads folder different.

Hint The flag is the string (not line number).

********************************************************* SOLUTION *********************************************************

cd C:\Users\CTF\Downloads
$comparisons = Compare-Object $(Get-Content new.txt) $(Get-Content old.txt)
$comparisons | Where-Object { $_.SideIndicator -eq '<=' -or $_.SideIndicator -eq '=>' } | ForEach-Object { $_.InputObject }

######################################################### Windows_PowerShell_Basics8 #########################################################

How many methods are available for the get-process cmdlet?

Machine: Admin_Station


********************************************************* SOLUTION *********************************************************

(Get-Process | Get-Member -MemberType Methods).Count

######################################################### Windows_PowerShell_Regex_5 15 #########################################################

Count the number of words in words.txt that meet the following criteria:

a appears at least twice consecutively
and is followed immediately by any of the letters a through g
Note: File Location - C:\Users\CTF\Desktop\CTF
Example: aac...aaa...

********************************************************* SOLUTION *********************************************************

cd C:\Users\CTF\Desktop\CTF

(Get-Content -Path .\words.txt | Where-Object { $_ -match "aa[a-g]" }).Count


######################################################### Windows_PowerShell_Alias3 10 #########################################################

How many aliases does PowerShell have for listing the contents of a directory?

********************************************************* SOLUTION *********************************************************

(Get-Alias | Where-Object { $_.Definition -eq 'Get-ChildItem' }).Count

######################################################### Windows_PowerShell_Alias3 10 #########################################################


In the CTF folder on the CTF User's Desktop, count the number of words in words2.txt.

********************************************************* SOLUTION *********************************************************

(Get-Content -Path .\words2.txt | ForEach-Object { $_ -split '\s+' } | Measure-Object).Count


######################################################### Windows_PowerShell_Alias3 10 #########################################################


The password is the 21st line from the top, in ASCII alphabetically-sorted, descending order of the words.txt file.

**Note: File Location - C:\Users\CTF\Desktop\CTF

********************************************************* SOLUTION *********************************************************

cd C:\Users\CTF\Desktop\CTF
(Get-Content -Path .\words.txt | Sort-Object {$_} -Descending)[20]


######################################################### Windows_Powershell_Logic9 10 #########################################################

Count the number of folders in the Music folder in the CTF user’s profile.

********************************************************* SOLUTION *********************************************************

(Get-ChildItem -Path C:\Users\CTF\Music -Directory).Count

######################################################### Windows_Powershell_Logic9 10 #########################################################




???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????

######################################################### Windows_PowerShell_Help4 10 #########################################################

When requesting the help file for the get-process cmdlet, what full command is the 9th example given?

********************************************************* SOLUTION *********************************************************

(Get-Help Get-Process -Examples).examples.example | Select-Object -Index 8 | ForEach-Object { $_.code.cdata }

Get-Help Get-Process -Examples - Retrieves the examples section of the help file for Get-Process.
.examples.example - Accesses the individual examples.
Select-Object -Index 8 - Retrieves the 9th example (since indexing starts from 0).
ForEach-Object { $_.code.cdata } - Extracts the code of the selected example.

######################################################### Windows_PowerShell_Logic4 10 #########################################################

Count the number of files in the Videos folder in the CTF user's home directory.

********************************************************* SOLUTION *********************************************************

(Get-ChildItem -Path C:\Users\CTF\Videos -File).Count

Get-ChildItem is a core cmdlet in PowerShell for item listing and retrieval from a variety of data sources and is fundamental to many scripting and automation tasks. It is a versatile cmdlet in PowerShell used primarily to retrieve a list of items from a provider's location, such as from a file system (like directories and files) or the registry.

Get-ChildItem C:\Users\CTF\Documents --> List Files and Directories: At its most basic level, when used against the file system, Get-ChildItem behaves similarly to the dir command in CMD or the ls command in Unix-based systems. It lists files and directories in the current or specified directory.

Get-ChildItem C:\Users\CTF\Documents -Recurse --> Recursive Listings: With the -Recurse parameter, it can retrieve items from a location and its sublocations (similar to ls -R).

Get-ChildItem C:\Users\CTF\Documents -Filter *.txt --> Filtering: You can use the -Filter parameter to retrieve only specific items based on a wildcard pattern.

Get-ChildItem C:\ -Force --> Hidden and System Items: By default, Get-ChildItem won't show hidden or system files. You can make them visible using the -Force parameter.

Get-ChildItem C:\Users\CTF\Documents -File --> Item Types: Using parameters like -File or -Directory, you can choose to list only files or only directories.

Get-ChildItem HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall --> Other Providers: Apart from the file system, Get-ChildItem can also list items from other providers, such as the registry, certificates, environment variables, etc. For example, to list items from the registry:

Get-ChildItem C:\Users\CTF\Documents | Select-Object Name, Length, CreationTime --> Listing Properties: It can also be used in conjunction with Select-Object to list specific properties of items.

######################################################### Windows_PowerShell_Logic7 10 #########################################################

Count the number of unique words in words.txt

**Note: File Location - C:\Users\CTF\Desktop\CTF

********************************************************* SOLUTION *********************************************************

$uniqueWordsCount = (Get-Content -Path C:\Users\CTF\Desktop\CTF\words.txt | ForEach-Object { $_ -split '\s+' } | Sort-Object -Unique).Count
$uniqueWordsCount

ForEach-Object { $_ -split '\s+'} -->  Splits each line into individual words using whitespace as a delimiter.

Sort-Object -Unique --> Sorts the words and filters out duplicates.

.Count --> Counts the number of unique words.

######################################################### Windows_PowerShell_Regex_2 10 #########################################################

Count the number of times, case-insensitive, gaab is listed in words.txt **Note: File Location - C:\Users\CTF\Desktop\CTF

********************************************************* SOLUTION *********************************************************

(Get-Content -Path C:\Users\CTF\Desktop\CTF\words.txt | Select-String -Pattern "gaab" -CaseSensitive:$false -AllMatches).Matches.Count

Select-String -Pattern "gaab": Searches for the pattern "gaab".
-CaseSensitive:$false: Makes the search case-insensitive.
-AllMatches: Captures all matches in the file.
.Matches.Count: Counts the number of matching instances.


######################################################### Windows_PowerShell_Logic8 15 #########################################################

Use a PowerShell loop to unzip the Omega file 1,000 times and read what is inside.

Note: Make sure you back up the .zip file to a different directory before attempting this challenge.

Zip file is located at C:\Users\CTF\Documents and is called Omega1000.zip copy the file to C:\Users\CTF\Desktop

********************************************************* SOLUTION *********************************************************


#FIND THE PATH TO OMEGA FILE

Compress-Archive -LiteralPath 'C:\Users\CTF\Documents\Omega1000.zip' -DestinationPath 'C:\Users\CTF\Desktop\Omega.zip' #COPY OMEGA ZIP TO A NEW LOCATION

Expand-Archive -LiteralPath 'C:\Users\CTF\Desktop\Omega1000.zip' -DestinationPath 'C:\Users\CTF\Desktop\UnzippedToFolder'

#UNZIP THE FIRST ITERATION - you now have a zipped folder (Omega999.zip) inside of an unzipped folder

· for($i = 0; $i -lt 1001; $i++){@(Get-ChildItem 'C:\Users\CTF\Desktop\UnzippedToFolder'| Sort-Object {$_.length})[0]| Expand-Archive -DestinationPath 'C:\Users\CTF\Desktop\UnzippedToFolder' -Force}

#UNZIP THE FILE 1000 TIMES

Expand-Archive -LiteralPath ‘C:\Users\CTF\Desktop\UnzippedToFolder\Omega1.zip’ -DestinationPath ‘‘C:\Users\CTF\Desktop\UnzippedToFolder

#UNZIP THE FINAL FILE (Omega1.zip)

Get-Content C:\Users\CTF\Desktop\UnzippedToFolder\Omega.txt

#READ THE LAST UNZIPPED FILE

kung-fu


>>>>>>>>>>>>>>>>>>> If you need to search for the omega file >>>>>>>>>>>>>

Get-ChildItem -Path "StartingDirectory" -Recurse -File | Where-Object { $_.Name -eq "FileName.ext" }

StartingDirectory: Replace this with the directory where you want to start your search. For example, C:\ to start from the root of the C drive.
FileName.ext: Replace this with the name of the file you're searching for, including its extension.

Get-ChildItem -Path "C:\" -Recurse -File | Where-Object { $_.Name -eq "document.txt" }

To search for a file ending in .zip files -- Get-ChildItem -Path "C:\" -Recurse -File -Filter "*.zip"


######################################################### Windows_PowerShell_Regex_5 15 #########################################################

Count the number of words in words.txt that meet the following criteria:

    a appears at least twice consecutively
    and is followed immediately by any of the letters a through g
    Note: File Location - C:\Users\CTF\Desktop\CTF
    Example: aac...aaa...

********************************************************* SOLUTION *********************************************************

(Get-Content -Path 'C:\Users\CTF\Desktop\CTF\words.txt' | 
    ForEach-Object { $_ -split '\s+' } | 
    Where-Object { $_ -match 'aa[a-g]' }).Count

ForEach-Object { $_ -split '\s+' }: Splits the content into individual words based on whitespace.
Where-Object { $_ -match 'aa[a-g]' }: Filters the words based on the regex pattern. This pattern matches words where a appears consecutively at least twice and is followed immediately by any letter from a to g.

######################################################### Windows_PowerShell_Regex_4 10 #########################################################

Count the number of lines that az appears in the words.txt file

Note: File Location - C:\Users\CTF\Desktop\CTF

********************************************************* SOLUTION *********************************************************

(Get-Content -Path 'C:\Users\CTF\Desktop\CTF\words.txt' | Where-Object { $_ -match 'az' }).Count

Where-Object { $_ -match 'az' }: Filters the lines based on the presence of the substring "az".


######################################################### Windows_PowerShell_CimClasses2 10 #########################################################

To complete this challenge, find the description of the Lego Land service.

Reminder: All challenges are done using the file-server.

********************************************************* SOLUTION *********************************************************

Get-WmiObject win32_service | ?{$_.Name -like 'LegoLand'} | select Description


######################################################### Windows_PowerShell_Help4 10 #########################################################

When requesting the help file for the get-process cmdlet, what full command is the 9th example given?

********************************************************* SOLUTION *********************************************************

Get-Process pwsh


######################################################### Primer_CLI_1 1 #########################################################

Which program starts with every CMD and PowerShell instance in Windows 7 and later?

Research: https://devblogs.microsoft.com/commandline/windows-command-line-inside-the-windows-console/

********************************************************* SOLUTION *********************************************************

conhost.exe


######################################################### Windows_PowerShell_Help1 5 #########################################################

What is the basic cmdlet that displays help about Windows Powershell cmdlets and concepts? - Get-help

********************************************************* SOLUTION *********************************************************


Go from Get-Item then Get-ChildItem and Get-ItemProperty

 Get-ItemProperty HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run

 net use * http://live.sysinternals.com
    has to be run from the z, directory that is automatically set, directory. 
    cd to the z directory   
    .\autoruns.exe --> pops up the user friendly gui. Dispalys GUI tools

Type *autoruns -accepteula*(accepteula exemps permission runs. Used when a command doesn't run)

HIVEs perform similar to a drive. 
check usbs in the registry = 


dir

######################################################### Windows_PowerShell_Regex_3 10 #########################################################

Count the number of words, case-insensitive, with either a or z in a word, in the words.txt file
Note: File Location - C:\Users\CTF\Desktop\CTF

********************************************************* SOLUTION *********************************************************

cd C:\Users\CTF\Desktop\CTF
(Get-Content -Path .\words.txt | Where-Object { $_ -imatch 'a' -or $_ -imatch 'z' }).Count

######################################################### Windows_PowerShell_CimClasses2 10 #########################################################

To complete this challenge, find the description of the Lego Land service.

Reminder: All challenges are done using the file-server.

********************************************************* SOLUTION *********************************************************

$serviceName = Get-Service | Where-Object { $_.DisplayName -like "*Lego Land*" }
$LegoLandDescription = Get-Service | Where-Object {$_.DisplayName -like "*Lego Land*" }

Get-CimInstance -ClassName Win32_Service -Filter "Name='$($serviceName.Name)'" | Select-Object Description
Get-CimInstance -ClassName Win32_Service -Filter "Name='$($LegoLandDescription.Name)'" | Select-Object Description


######################################################### Windows_PowerShell_Logic5 10 #########################################################

Find the only line that makes the two files in the CTF user's Downloads folder different.

Hint The flag is the string (not line number).

********************************************************* SOLUTION *********************************************************

cd C:\Users\CTF\Downloads
$comparisons = Compare-Object $(Get-Content new.txt) $(Get-Content old.txt)
$comparisons | Where-Object { $_.SideIndicator -eq '<=' -or $_.SideIndicator -eq '=>' } | ForEach-Object { $_.InputObject }

######################################################### Windows_PowerShell_Basics8 #########################################################

How many methods are available for the get-process cmdlet?

Machine: Admin_Station


********************************************************* SOLUTION *********************************************************

(Get-Process | Get-Member -MemberType Methods).Count

######################################################### Windows_PowerShell_Regex_5 15 #########################################################

Count the number of words in words.txt that meet the following criteria:

a appears at least twice consecutively
and is followed immediately by any of the letters a through g
Note: File Location - C:\Users\CTF\Desktop\CTF
Example: aac...aaa...

********************************************************* SOLUTION *********************************************************

cd C:\Users\CTF\Desktop\CTF

(Get-Content -Path .\words.txt | Where-Object { $_ -match "aa[a-g]" }).Count


######################################################### Windows_PowerShell_Alias3 10 #########################################################

How many aliases does PowerShell have for listing the contents of a directory?

********************************************************* SOLUTION *********************************************************

(Get-Alias | Where-Object { $_.Definition -eq 'Get-ChildItem' }).Count

######################################################### Windows_PowerShell_Alias3 10 #########################################################


In the CTF folder on the CTF User's Desktop, count the number of words in words2.txt.

********************************************************* SOLUTION *********************************************************

(Get-Content -Path .\words2.txt | ForEach-Object { $_ -split '\s+' } | Measure-Object).Count


######################################################### Windows_PowerShell_Alias3 10 #########################################################


The password is the 21st line from the top, in ASCII alphabetically-sorted, descending order of the words.txt file.

**Note: File Location - C:\Users\CTF\Desktop\CTF

********************************************************* SOLUTION *********************************************************

cd C:\Users\CTF\Desktop\CTF
(Get-Content -Path .\words.txt | Sort-Object {$_} -Descending)[20]


######################################################### Windows_Powershell_Logic9 10 #########################################################

Count the number of folders in the Music folder in the CTF user’s profile.

********************************************************* SOLUTION *********************************************************

(Get-ChildItem -Path C:\Users\CTF\Music -Directory).Count

######################################################### Windows_PowerShell_Help4 10 #########################################################

When requesting the help file for the get-process cmdlet, what full command is the 9th example given?

********************************************************* SOLUTION *********************************************************

(Get-Help Get-Process -Examples).examples.example | Select-Object -Index 8 | ForEach-Object { $_.code.cdata }

Get-Help Get-Process -Examples - Retrieves the examples section of the help file for Get-Process.
.examples.example - Accesses the individual examples.
Select-Object -Index 8 - Retrieves the 9th example (since indexing starts from 0).
ForEach-Object { $_.code.cdata } - Extracts the code of the selected example.

######################################################### Windows_PowerShell_Logic4 10 #########################################################

Count the number of files in the Videos folder in the CTF user's home directory.

********************************************************* SOLUTION *********************************************************

(Get-ChildItem -Path C:\Users\CTF\Videos -File).Count

Get-ChildItem is a core cmdlet in PowerShell for item listing and retrieval from a variety of data sources and is fundamental to many scripting and automation tasks. It is a versatile cmdlet in PowerShell used primarily to retrieve a list of items from a provider's location, such as from a file system (like directories and files) or the registry.

Get-ChildItem C:\Users\CTF\Documents --> List Files and Directories: At its most basic level, when used against the file system, Get-ChildItem behaves similarly to the dir command in CMD or the ls command in Unix-based systems. It lists files and directories in the current or specified directory.

Get-ChildItem C:\Users\CTF\Documents -Recurse --> Recursive Listings: With the -Recurse parameter, it can retrieve items from a location and its sublocations (similar to ls -R).

Get-ChildItem C:\Users\CTF\Documents -Filter *.txt --> Filtering: You can use the -Filter parameter to retrieve only specific items based on a wildcard pattern.

Get-ChildItem C:\ -Force --> Hidden and System Items: By default, Get-ChildItem won't show hidden or system files. You can make them visible using the -Force parameter.

Get-ChildItem C:\Users\CTF\Documents -File --> Item Types: Using parameters like -File or -Directory, you can choose to list only files or only directories.

Get-ChildItem HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall --> Other Providers: Apart from the file system, Get-ChildItem can also list items from other providers, such as the registry, certificates, environment variables, etc. For example, to list items from the registry:

Get-ChildItem C:\Users\CTF\Documents | Select-Object Name, Length, CreationTime --> Listing Properties: It can also be used in conjunction with Select-Object to list specific properties of items.

######################################################### Windows_PowerShell_Logic7 10 #########################################################

Count the number of unique words in words.txt

**Note: File Location - C:\Users\CTF\Desktop\CTF

********************************************************* SOLUTION *********************************************************

$uniqueWordsCount = (Get-Content -Path C:\Users\CTF\Desktop\CTF\words.txt | ForEach-Object { $_ -split '\s+' } | Sort-Object -Unique).Count
$uniqueWordsCount

ForEach-Object { $_ -split '\s+'} -->  Splits each line into individual words using whitespace as a delimiter.

Sort-Object -Unique --> Sorts the words and filters out duplicates.

.Count --> Counts the number of unique words.

######################################################### Windows_PowerShell_Regex_2 10 #########################################################

Count the number of times, case-insensitive, gaab is listed in words.txt **Note: File Location - C:\Users\CTF\Desktop\CTF

********************************************************* SOLUTION *********************************************************

(Get-Content -Path C:\Users\CTF\Desktop\CTF\words.txt | Select-String -Pattern "gaab" -CaseSensitive:$false -AllMatches).Matches.Count

Select-String -Pattern "gaab": Searches for the pattern "gaab".
-CaseSensitive:$false: Makes the search case-insensitive.
-AllMatches: Captures all matches in the file.
.Matches.Count: Counts the number of matching instances.


######################################################### Windows_PowerShell_Logic8 15 #########################################################

Use a PowerShell loop to unzip the Omega file 1,000 times and read what is inside.

Note: Make sure you back up the .zip file to a different directory before attempting this challenge.

Zip file is located at C:\Users\CTF\Documents and is called Omega1000.zip copy the file to C:\Users\CTF\Desktop

********************************************************* SOLUTION *********************************************************


Copy-Item -Path "C:\Users\CTF\Desktop\Omega1000.zip" -Destination "C:\Users\CTF\Documents\Omega1000.zip"

Expand-Archive -Path "C:\path_to_zip\sample.zip" -DestinationPath "C:\path_to_extracted_folder\extracted"


for ($i = 0; $i -lt 1000; $i++) {
    # Unzip the file
    Expand-Archive -Path "C:\Users\CTF\Documents\Omega1000.zip" -DestinationPath "C:\Users\CTF\Documents\temporary_folder" -Force
}



for ($i = 0; $i -lt 1000; $i++) {
    Expand-Archive -Path . -Filter "*.zip" -DestinationPath "C:\Users\CTF\Documents\temporary_folder" -Force
}


$zipFiles = Get-ChildItem -Path . -Filter "*.zip"

# Define the directory path
$directoryPath = "C:\Users\CTF\Documents\temporary_folder\"

# Get all .zip files in the directory
$zipFiles = Get-ChildItem -Path $directoryPath -Filter "*.zip"

# Loop through each zip file and unzip it
foreach ($zip in $zipFiles) {
    # Define the destination folder for extraction (same name as the zip file but without the .zip extension)
    $destinationFolder = Join-Path -Path $directoryPath -ChildPath ($zip.BaseName)
    
    # Extract the zip file to the destination folder
    Expand-Archive -Path $zip.FullName -DestinationPath $destinationFolder
}


# Get all .zip files in the current directory
$zipFiles = Get-ChildItem -Path . -Filter "*.zip"

# Loop through each zip file and unzip it
foreach ($zip in $zipFiles) {
    # Define the destination folder for extraction (same name as the zip file but without the .zip extension)
    $destinationFolder = Join-Path -Path $zip.DirectoryName -ChildPath ($zip.BaseName)
    
    # Extract the zip file to the destination folder
    Expand-Archive -Path $zip.FullName -DestinationPath $destinationFolder
}




######################################################### Windows_PowerShell_Regex_5 15 #########################################################

Count the number of words in words.txt that meet the following criteria:

    a appears at least twice consecutively
    and is followed immediately by any of the letters a through g
    Note: File Location - C:\Users\CTF\Desktop\CTF
    Example: aac...aaa...

********************************************************* SOLUTION *********************************************************

(Get-Content -Path 'C:\Users\CTF\Desktop\CTF\words.txt' | 
    ForEach-Object { $_ -split '\s+' } | 
    Where-Object { $_ -match 'aa[a-g]' }).Count

ForEach-Object { $_ -split '\s+' }: Splits the content into individual words based on whitespace.
Where-Object { $_ -match 'aa[a-g]' }: Filters the words based on the regex pattern. This pattern matches words where a appears consecutively at least twice and is followed immediately by any letter from a to g.

######################################################### Windows_PowerShell_Regex_4 10 #########################################################

Count the number of lines that az appears in the words.txt file

Note: File Location - C:\Users\CTF\Desktop\CTF

********************************************************* SOLUTION *********************************************************

(Get-Content -Path 'C:\Users\CTF\Desktop\CTF\words.txt' | Where-Object { $_ -match 'az' }).Count

Where-Object { $_ -match 'az' }: Filters the lines based on the presence of the substring "az".


######################################################### Windows_PowerShell_CimClasses2 10 #########################################################

To complete this challenge, find the description of the Lego Land service.

Reminder: All challenges are done using the file-server.

********************************************************* SOLUTION *********************************************************

Get-WmiObject win32_service | ?{$_.Name -like 'LegoLand'} | select Description


######################################################### Windows_PowerShell_Help4 10 #########################################################

When requesting the help file for the get-process cmdlet, what full command is the 9th example given?

********************************************************* SOLUTION *********************************************************

Get-Process pwsh


######################################################### Primer_CLI_1 1 #########################################################

Which program starts with every CMD and PowerShell instance in Windows 7 and later?

Research: https://devblogs.microsoft.com/commandline/windows-command-line-inside-the-windows-console/

********************************************************* SOLUTION *********************************************************

conhost.exe


######################################################### Primer_CLI_2 1 #########################################################

What Windows 10 feature supports installing Linux subsystem?

Research: https://learn.microsoft.com/en-us/windows/wsl/about

********************************************************* SOLUTION *********************************************************

WSL 

######################################################### Primer_CLI_3 1 #########################################################

Which Windows feature can be used to interact with any CLI on the Windows system concurrently using multiple tabs?

Research: https://learn.microsoft.com/en-us/windows/terminal/


********************************************************* SOLUTION *********************************************************

Windows Terminal 


######################################################### Primer_CLI_4 1 #########################################################

What was the default shell (command line) of Windows versions Windows 2000 through Windows 8.1?

Research: https://learn.microsoft.com/en-us/windows-hardware/customize/enterprise/shell-launcher


********************************************************* SOLUTION *********************************************************

Command Prompt


######################################################### Primer_CLI_4 1 #########################################################

What was the default shell (command line) of Windows versions Windows 2000 through Windows 8.1?

Research: https://learn.microsoft.com/en-us/windows-hardware/customize/enterprise/shell-launcher


********************************************************* SOLUTION *********************************************************

Command Prompt


######################################################### Primer_CLI_5 1 #########################################################

What data type do all cmd.exe commands return?

Research: https://en.wikipedia.org/wiki/Comparison_of_command_shells (Hint: What data type is "text"?)


********************************************************* SOLUTION *********************************************************

String 


######################################################### Primer_CLI_6 1 #########################################################

What framework is PowerShell built on?

Research: https://en.wikipedia.org/wiki/.NET

********************************************************* SOLUTION *********************************************************

.NET

######################################################### Primer_CLI_7 1 #########################################################

"What will all of the below give you?

(get-host).version

$host.version

$psversiontable.psversion"

Research: https://devblogs.microsoft.com/scripting/powertip-check-version-of-powershell/



********************************************************* SOLUTION *********************************************************


PowerShell Version


######################################################### Primer_CLI_8 1 #########################################################

After PowerShell Core is installed what CLI command launches it?

Research: https://learn.microsoft.com/en-us/powershell/scripting/install/installing-powershell-on-windows?view=powershell-7.2



********************************************************* SOLUTION *********************************************************

pwsh 

######################################################### Primer_CLI_9 1 #########################################################

"After PowerShell Core is installed you can still run the built in version of PowerShell side-by-side. What CLI command will launch the built in version?"

Research: Primer_CLI_9 https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/powershell

********************************************************* SOLUTION *********************************************************


powershell
 


######################################################################################################################################################
######################################################                                             ###################################################
######################################################        02_windows_powershell_profiles       ####################################################
######################################################                                             ###################################################
######################################################################################################################################################



######################################################### Windows_PowerShell_Profiles1 5 #########################################################

Which PowerShell profile has the lowest precedence?

********************************************************* SOLUTION *********************************************************

Current user, Current Host 

######################################################### Windows_PowerShell_Profiles2 5 #########################################################

Which PowerShell profile has the highest precedence?

********************************************************* SOLUTION *********************************************************

All Users, All Hosts 

######################################################### Windows_PowerShell_Profiles3 5 #########################################################


Which PowerShell variable stores the current user’s home directory?


********************************************************* SOLUTION *********************************************************

$HOME

######################################################### Windows_PowerShell_Profiles5 5 #########################################################

Which PowerShell variable stores the path to the "Current User, Current Host" profile?

********************************************************* SOLUTION *********************************************************

$PROFILE

######################################################### Windows_PowerShell_Profiles6 5 #########################################################

What command would you run to view the help for PowerShell Profiles?

********************************************************* SOLUTION *********************************************************

Get-Help about_Profiles

######################################################### Windows_PowerShell_Profiles7 5 #########################################################


What command would tell you if there was a profile loaded for All Users All Hosts?

Flag is the full command syntax

********************************************************* SOLUTION *********************************************************

Test-Path $profile.AllUsersAllHosts

######################################################### Windows_PowerShell_Profiles8 10 #########################################################

Challenge only allows ONE attempt

Malware is running in a PowerShell profile on the File-Server. Based on PowerShell profile order of precedence (what is read first), find the correct flag.

The flag is the string after the #, without the preceding space.


********************************************************* SOLUTION *********************************************************

Get-Content $profile.AllUsersAllHosts


I am certainly not the malware

#########################################################################################################################################
#########################################################                       #########################################################
#########################################################  05_WINDOWS_REGISTRY  #########################################################
#########################################################                       #########################################################
#########################################################################################################################################


######################################################### Primer_Registry_1 1 #########################################################

What Windows registry path is the Volatile Hive?

Research: https://vistech.net/~champ/online-docs/books/mwin2reg/ch11-30975.html

********************************************************* SOLUTION *********************************************************

HKLM\HARDWARE

######################################################### Primer_Registry_2 1 #########################################################

What registry key creates the Wow6432Node to represent 32-bit applications that run on a 64-bit version of Windows?

Research: https://learn.microsoft.com/en-us/troubleshoot/windows-client/application-management/wow6432node-registry-key-present-32-bit-machine

********************************************************* SOLUTION *********************************************************

HKEY_LOCAL_MACHINE\SOFTWARE

######################################################### Primer_Registry_3 1 #########################################################

In what registry path are the BOOT_START drivers located?

Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/install/hklm-system-currentcontrolset-services-registry-tree

********************************************************* SOLUTION *********************************************************

HKLM\SYSTEM\CurrentControlSet\Services

######################################################### Primer_Registry_4 1 #########################################################

What start value do BOOT_START drivers have in the registry?

Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/install/specifying-driver-load-order

********************************************************* SOLUTION *********************************************************

0x0



#########################################################  Primer_Registry_5 1 #########################################################

During kernel initialization, what registry location is read containing all SYSTEM_START drivers?

Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/install/hklm-system-currentcontrolset-services-registry-tree

********************************************************* SOLUTION *********************************************************

HKLM\SYSTEM\CurrentControlSet\Services



#########################################################  Primer_Registry_6 1 #########################################################

SERVICE_AUTO_START drivers and services are loaded after kernel initialization. What start value do they have in the registry?

Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/install/specifying-driver-load-order

********************************************************* SOLUTION *********************************************************
0x02

######################################################### Primer_Registry_7 1 #########################################################

What start value do SERVICE_DEMAND_START drivers and services have in the registry?

Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/install/specifying-driver-load-order


********************************************************* SOLUTION *********************************************************

0x3




######################################################### Primer_Registry_7 1 #########################################################

What start value do SERVICE_DEMAND_START drivers and services have in the registry?

Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/install/specifying-driver-load-order

********************************************************* SOLUTION *********************************************************
Registry Editor



######################################################### Primer_Registry_8 1 #########################################################

When accessing a remote registry which are the only 2 accessible HKEYs?

SYNTAX Hive, Hive

Research: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/reg-load

********************************************************* SOLUTION *********************************************************
HKEY_LOCAL_MACHINE, HKEY_USERS




######################################################### Primer_Registry_9 1 #########################################################

What PowerShell cmdlet will list currently mapped drives?

Research: https://learn.microsoft.com/en-us/powershell/scripting/samples/managing-windows-powershell-drives?view=powershell-7.2

********************************************************* SOLUTION *********************************************************
Get-PSDrive



######################################################### Primer_Registry_10 1 #########################################################

What is the native Windows GUI tool for managing the registry?

Research: https://support.microsoft.com/en-us/windows/how-to-open-registry-editor-in-windows-10-deab38e6-91d6-e0aa-4b7c-8878d9e07b11

********************************************************* SOLUTION *********************************************************
Registry Editor



######################################################### Windows_Registry_Basics_1 5 #########################################################

What registry hive contains all machine settings?

********************************************************* SOLUTION *********************************************************

HKEY_LOCAL_MACHINE (often abbreviated as HKLM)



######################################################### Windows_Registry_Basics_2 5 #########################################################

What registry hive contains all user settings?

********************************************************* SOLUTION *********************************************************
HKEY_USERS




######################################################### Windows_Registry_Basics_3 5 #########################################################

What registry hive contains only the currently logged-in user's settings?

********************************************************* SOLUTION *********************************************************
HKEY_CURRENT_USER (often abbreviated as HKCU)



######################################################### Windows_Registry_Basics_4 5 #########################################################

The HKEY_CURRENT_USER registry hive is a symbolic link to another registry subkey. What is the subkey that it is linked to?

Flag format: HIVE\SID.........................

Reminder: All challenges are done using Workstation2.

********************************************************* SOLUTION *********************************************************

THIS GETS YOU THE USER ID 

(Get-WmiObject -Class Win32_UserAccount -Filter "Name='$env:USERNAME'").SID

HKU\S-1-5-21-2881336348-3190591231-4063445930-1004


######################################################### Windows_Registry_Basics_5 5 #########################################################

What PowerShell command will list all the subkeys and contents in the current directory and/or will list all the subkeys and the contents of a directory you specify?

********************************************************* SOLUTION *********************************************************
Get-ChildItem



######################################################### Windows_Registry_Basics_6 5 #########################################################

What PowerShell command will list only the contents of a registry key or subkey?

********************************************************* SOLUTION *********************************************************
HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUN

Get-item




######################################################### Windows_Registry_Basics_7 10 #########################################################


What registry subkey runs every time the machine reboots? The flag is the full path, using PowerShell.

Flag format: FULL\PATH\ALL\CAPS

********************************************************* SOLUTION *********************************************************
HKEY_CURRENT_USER\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUN



######################################################### Windows_Registry_Basics_8 10 #########################################################

What registry subkey runs every time a user logs on? The flag is the full path, using PowerShell.

Flag format: FULL\PATH\ALL\CAPS

********************************************************* SOLUTION *********************************************************

HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUNONCE


#########################################################  Windows_Registry_Basics_9 10 #########################################################

What registry subkey runs a single time, then deletes its value once the machine reboots? The flag is the full path, using PowerShell.

Flag format: FULL\PATH\ALL\CAPS

********************************************************* SOLUTION *********************************************************

HKEY_CURRENT_USER\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUNONCE


######################################################### Windows_Registry_Basics_10 10 #########################################################

What registry subkey runs a single time, then deletes its value when a user logs on? The flag is the full path, using PowerShell.

Flag format: FULL\PATH\ALL\CAPS

********************************************************* SOLUTION *********************************************************





######################################################### Windows_Registry_Basics_11 15 #########################################################

What is the value inside of the registry subkey from your previous challenge named registry_basics_7?

********************************************************* SOLUTION *********************************************************
Go to workstation 2 

Get-Item Registry::HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUN

malware.exe

######################################################### Windows_Registry_Basics_12 15 #########################################################

What is the value inside of the registry subkey that loads every time the "Student" user logs on?

Get-ItemProperty -Path 'Registry::HKEY_USERS\S-1-5-21-2881336348-3190591231-4063445930-1004\SOFTWARE\Microsoft\Windows\CurrentVersion\Run'


********************************************************* SOLUTION *********************************************************

Get-LocalUser | select Name, SID #See all the SIDs and find the one for student
get-Item -path Registry::HKEY_USERS\S-1-5-21-2881336348-3190591231-4063445930-1003\Software\Microsoft\Windows\CurrentVersion\Run
C:\botnet.exe 


######################################################### Windows_Registry_Basics_13 15 #########################################################

What is the value inside of the registry subkey from registry_basics_9?

********************************************************* SOLUTION *********************************************************

Go to workstation 2 
Get-Item Registry::HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUNONCE 
· C:\virus.exe


######################################################### Windows_Registry_Basics_14 15 #########################################################

What is the value inside of the registry subkey that loads a single time when the "student" user logs on?

********************************************************* SOLUTION *********************************************************
Get-Item -Path Registry::HKEY_USERS\S-1-5-21-2881336348-3190591231-4063445930-1003\SOFTWARE\Microsoft\Windows\CurrentVersion\RUNONCE



######################################################### Windows_Registry_Basics_15 15 #########################################################

Figure out the manufacturer's name of the only USB drive that was plugged into this machine.
SanDisk

********************************************************* SOLUTION *********************************************************

Get-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Enum\USBSTOR

######################################################### Windows_Registry_Basics_16 15 #########################################################

What suspicious user profile, found in the registry, has connected to this machine?


********************************************************* SOLUTION *********************************************************

Get-ChildItem 'HKLM:\Software\Microsoft\Windows NT\CurrentVersion\ProfileList'

· Hacker_McHackerson

######################################################### Windows_Registry_Basics_17 15 #########################################################

What suspicious wireless network, found in the registry, has this system connected to?

********************************************************* SOLUTION *********************************************************

· Get-ChildItem 'HKLM:\Software\Microsoft\Windows NT\CurrentVersion\NetworkList\Profiles'

· Terror_cafe_network




######################################################################################################################################################
#########################################################                                    #########################################################
#########################################################  06_WINDOWS_ALTERNATE_DATA_STREAM  #########################################################
#########################################################                                    #########################################################
######################################################################################################################################################



#########################################################  #########################################################

The ____ determines how the data is stored on disk.

(Fill in the blank)

Research: https://social.technet.microsoft.com/wiki/contents/articles/5375.windows-file-systems.aspx

********************************************************* SOLUTION *********************************************************

file system

######################################################### Primer_NTFS_2 1 #########################################################

What are NTFS partition sectors grouped into?

Research: https://learn.microsoft.com/en-us/windows-server/storage/file-server/ntfs-overview


********************************************************* SOLUTION *********************************************************
clusters

######################################################### Primer_NTFS_3 1 #########################################################

What contains the metadata about all of the files and directories on a NTFS partition?

Research: https://learn.microsoft.com/en-us/windows/win32/devnotes/master-file-table


********************************************************* SOLUTION *********************************************************

Master File Table

######################################################### Primer_NTFS_4 1 #########################################################

NTFS files are collections of what?

(Hint: What are the user data streams? or all streams for that matter) Research: https://learn.microsoft.com/en-us/windows/win32/devnotes/master-file-table

********************************************************* SOLUTION *********************************************************

attributes

######################################################### Primer_NTFS_5 1 #########################################################

Which NTFS attribute would store an alternate data stream?

Research: https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-fscc/c54dec26-1551-4d3a-a0ea-4fa40f848eb3

********************************************************* SOLUTION *********************************************************
$DATA


######################################################### Primer_NTFS_6 1 #########################################################

Which NTFS attribute holds information about a file's encrypted attributes?

Research:

https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-fscc/a82e9105-2405-4e37-b2c3-28c773902d85


********************************************************* SOLUTION *********************************************************

$LOGGED_UTILITY_STREAM



######################################################### Primer_NTFS_7 1 #########################################################

Which NTFS attribute that is composed of the file security and access control properties?

Research: https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-fscc/a82e9105-2405-4e37-b2c3-28c773902d85


********************************************************* SOLUTION *********************************************************
$SECURITY_DESCRIPTOR


######################################################### Primer_NTFS_8 1 #########################################################

In NTFS, what is the type id, in hex, of the attribute that actually stores a NTFS files contents?

Research: https://flatcap.github.io/linux-ntfs/ntfs/attributes/data.html

********************************************************* SOLUTION *********************************************************

0x80



######################################################### Primer_NTFS_9 1 #########################################################

In NTFS what is the maximum number of bytes a MFT entry (containing the entirety of a file) can contain to be considered "Resident Data"?

Research: https://en.wikipedia.org/wiki/NTFS https://unminioncurioso.blogspot.com/2019/05/dfir-one-byte-makes-difference-mft.html


********************************************************* SOLUTION *********************************************************
1024


######################################################### Primer_NTFS_10 1 #########################################################

NTFS permissions can be a assigned to a filesystem object in two ways. Which way is intentionally assigned on the file or folder?

Research: https://devblogs.microsoft.com/scripting/weekend-scripter-use-powershell-to-get-add-and-remove-ntfs-permissions/


********************************************************* SOLUTION *********************************************************

Explicit


######################################################### Primer_NTFS_11 1 #########################################################

NTFS permissions can be a assigned to a filesystem object in two ways. Which way is the results of an object being assigned permissions as the result of being the child of another object?

Research: https://devblogs.microsoft.com/scripting/weekend-scripter-manage-ntfs-inheritance-and-use-privileges/

********************************************************* SOLUTION *********************************************************

inherited


######################################################### Primer_NTFS_12 1 #########################################################

Which NTFS file level permission is missing from the following list? Write, Read & Execute, Modify, Full Control

Research: https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc783530(v=ws.10)?redirectedfrom=MSDN

********************************************************* SOLUTION *********************************************************
Read


######################################################### Primer_NTFS_13 1 #########################################################

Which NTFS folder level permission is missing from the following list?: Read, Write, Read & Execute, Modify, Full control

Research: https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc783530(v=ws.10)?redirectedfrom=MSDN


********************************************************* SOLUTION *********************************************************
List Folder Contents


######################################################### Primer_NTFS_14 1 #########################################################

Which NTFS file level permission permits changing the contents of a file, deleting the file but does not allow the ability to change the permissions on the file?

Research: https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc783530(v=ws.10)?redirectedfrom=MSDN

********************************************************* SOLUTION *********************************************************
Modify



######################################################### Primer_NTFS_15 1 #########################################################


Which NTFS folder level permission allows changing permissions?

Research: https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc783530(v=ws.10)?redirectedfrom=MSDN

********************************************************* SOLUTION *********************************************************
 Full Control


######################################################### Primer_NTFS_16 1 #########################################################


Which NTFS attribute stores the file times of an object?

Research: https://flatcap.github.io/linux-ntfs/ntfs/attributes/standard_information.html

********************************************************* SOLUTION *********************************************************
$STANDARD_INFORMATION


######################################################### Primer_NTFS_17 1 #########################################################


What CLI command will only show the letters of attached drives? **Hint command is 3 words

Research: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/fsutil-fsinfo

********************************************************* SOLUTION *********************************************************
fsutil fsinfo drives


######################################################### Windows_File_System_Basics_1 5 #########################################################

Every file on a Windows system has attributes. What does the d attribute mean?

********************************************************* SOLUTION *********************************************************

directory

######################################################### Windows_File_System_Basics_2 5 #########################################################

Every file on a Windows system has attributes. What does the h attribute mean?

********************************************************* SOLUTION *********************************************************

hidden

######################################################### Windows_File_System_Basics_3 5 #########################################################

What PowerShell command will list all files in the current directory, regardless of their attributes?

********************************************************* SOLUTION *********************************************************

Get-Childitem -Force

######################################################### Windows_File_System_Basics_4 5 #########################################################

What PowerShell command will give you the sha512 hash of a file?

Flag format: command -argument

********************************************************* SOLUTION *********************************************************

Get-FileHash -Algorithm SHA512

#########################################################  Windows_File_System_Basics_5 5 #########################################################

What PowerShell command will list permissions of a file?

********************************************************* SOLUTION *********************************************************

Get-Acl

######################################################### Windows_File_System_Basics_6 5 #########################################################

What Windows file maps hostnames to IP addresses?

********************************************************* SOLUTION *********************************************************

hosts

######################################################### Windows_File_System_Basics_7 10 #########################################################

Which group has ReadandExecute (RX) permissions to the file listed in the previous challenge, File_System_Basics_6?

********************************************************* SOLUTION *********************************************************

hosts

#########################################################  #########################################################

Get-ChildItem $Path "hosts" -Recurse #SEARCH FOR FILENAME hosts ensure to cd... all the way back to C:\

cd C:\Windows\System32\drivers\etc #Change directory to location of hosts

get-acl hosts |ft -Wrap #DISPLAY PERMISIONS

BUILTIN\Users

********************************************************* SOLUTION *********************************************************

######################################################### Windows_File_System_Basics_8 10 #########################################################

Find the last five characters of the MD5 hash of the hosts file.


********************************************************* SOLUTION *********************************************************

get-FileHash -Algorithm MD5 hosts

7566D

######################################################### Windows_File_System_Basics_9 10 #########################################################

Examine the readme file somewhere in the CTF user’s home directory.

Reminder: All challenges are done on the file-server.

********************************************************* SOLUTION *********************************************************


$readmePath = Get-ChildItem -Path C:\Users\CTF\ -Recurse -File -ErrorAction SilentlyContinue | Where-Object { $_.Name -eq 'readme' }

Get-Content -Path $readmePath.FullName

######################################################### Windows_File_System_Basics_10 10 #########################################################

There is a hidden directory in the CTF user's home directory. The directory contains a file. Read the file.

********************************************************* SOLUTION *********************************************************

cd C:\Users\CTF
cd .\secretsauce\
Get-Content .\saucey
Mustard

######################################################### Windows_File_System_Basics_11 10 #########################################################


Find a file in a directory on the desktop with spaces in it. FLAG is the contents of the file

HINT: If you like to type the full names and paths of files, you better look for a shortcut.

********************************************************* SOLUTION ********************************************************

# Navigate to the specified directory
Set-Location "C:\Users\CTF\Desktop"

# List all items in the current directory, including hidden ones
Get-ChildItem -Force

# Change to the directory named 'z'
Set-Location 'z*'

# Display the content of the 'spaces.txt' file
Get-Content '.\spaces.txt'


######################################################### Windows_File_System_Basics_12 10 #########################################################

Find the Alternate Data Stream in the CTF user's home, and read it.

********************************************************* SOLUTION ********************************************************

Get-ChildItem -recurse | ForEach { Get-Item $_.FullName -stream * } | Where stream -ne ':$DATA'

Get-Content C:\Users\CTF\Documents\nothing_here -stream Hidden

HIDD3NK3Yls 

######################################################### Windows_File_System_Basics_13 15 #########################################################

"Fortune cookies" have been left around the system so that you won't find the hidden password...

********************************************************* SOLUTION ********************************************************

$fortunepath = Get-ChildItem -Path C:\ -Recurse -Force -Include '*Fortune*' -ErrorAction SilentlyContinue

Get-Item 'C:\Windows\PLA\not_anihc\The Fortune Cookie' -Stream *

Get-Item 'C:\Windows\PLA\not_anihc\The Fortune Cookie' | Get-Content -stream none

fortune_cookie

######################################################### Windows_File_System_Basics_14 15 #########################################################

There are plenty of phish in the C:\Users\CTF, but sometimes they're hidden in plain site.

Find the phish.

********************************************************* SOLUTION ********************************************************

%%%%%%%%%%%%%%%%%%%%% ??????????????????????????? %%%%%%%%%%%%%%%%%%%%%%%%%%%%
Get-ChildItem C:\ -Recurse -Force -Include www -ErrorAction SilentlyContinue

cd C:\Users\CTF\Documents\WWW

ls -Force

for($i=0; $i -lt 400; $i++){get-content $i} #OR

get-content 200 #LENGTH OF 200(30) GREATER THAN 0

Flag: phi5hy 





######################################################################################################################################################
######################################################                                             ###################################################
######################################################           09_windows_process_validity      ####################################################
######################################################                                             ###################################################
######################################################################################################################################################


######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************


######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************

######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************
######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************

######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************

######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************

######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************

######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************

######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************

######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************

######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************

######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************


######################################################### Windows_Processes_Basics_3 5 #########################################################

What Sysinternals tool shows malware persistence locations in tabs within its GUI?

Research: https://learn.microsoft.com/en-us/sysinternals

********************************************************* SOLUTION ********************************************************

Autoruns

######################################################### Windows_Processes_Basics_2 5 #########################################################

What Sysinternals tool is used to investigate processes?

********************************************************* SOLUTION ********************************************************

Procexp

######################################################### Windows_Processes_Basics_3 5 #########################################################

What Sysinternals tool can be used to investigate network connection attempts?

********************************************************* SOLUTION ********************************************************

TCPView

######################################################### Windows_Processes_Basics_4 5 #########################################################

What Sysinternals tool can view permissions?

********************************************************* SOLUTION ********************************************************

AccessChk

######################################################### Windows_Processes_Basics_5 5 #########################################################

What Sysinternals tool allows us to view and modify handles?

********************************************************* SOLUTION ********************************************************

handle

######################################################### Windows_Processes_Basics_6 5 #########################################################

What is the default Windows user directory for files downloaded from the internet? The flag is the folder name only.

********************************************************* SOLUTION ********************************************************

Downloads

######################################################### Windows_Processes_Basics_7 5 #########################################################

What is the default Windows download directory that everyone has access to? The flag is the absolute path to the directory.

********************************************************* SOLUTION ********************************************************

C:\Users\Public\Downloads

######################################################### Windows_Processes_Basics_8 5 #########################################################

What Sysinternals tool shows service load order?

********************************************************* SOLUTION ********************************************************

LoadOrd

######################################################### Windows_Processes_Basics_9 5 #########################################################

What is the service name of Windows Defender Firewall?

********************************************************* SOLUTION ********************************************************

Mpssvc

######################################################### Windows_Processes_Basics_10 5 #########################################################

What SysInternals tool reports .dlls loaded into processes?

********************************************************* SOLUTION ********************************************************

ListDLLs

######################################################### Windows_Hidden_Processes_1 10 #########################################################

There is malware on the system that is named similarly to a legitimate Windows executable. There is a .dll in the folder that the malware runs from. The flag is the name of the .dll.

Reminder: All challenges are done using Workstation1.

********************************************************* SOLUTION ********************************************************

go to command prompt and run these:
net use z: /d
xcopy /s z:\ c:\sysinternals\
net use * http://live.sysinternals.com # Autoruns directory should now be available 

got to the c directory and open autoruns 

look for a suspicious exe and cd to the directory to find the .dll 

In this case, TotallyLegit that resides in C:\Users\Public\Downloads\


######################################################### Windows_Hidden_Processes_2 10 #########################################################

You notice that there is an annoying pop up happening regularly. Investigate the process causing it. The flag is the name of the executable.

********************************************************* SOLUTION ********************************************************

Go to Autoruns and go to scheduled task........ McAfee Keep-alive looks suscpicious

right click and do Jump to Entry 
Select McAfee Keep Alive and select Actions....> Expand the pipe in the box to see the .exe file -> McAfeeFireTray.exe

######################################################### Windows_Hidden_Processes_3 10 #########################################################

Determine what is sending out a SYN_SENT message. The flag is the name of the executable.

HINT: Use a Sysinternals tool.

********************************************************* SOLUTION ********************************************************

Open TCPView

Get-NetTCPConnection -State SynSent #powershell

Run TCP View

Sort by name or state

Find synsent -> answer is McAfeeFireTray.exe

######################################################### Windows_Hidden_Processes_4 10 #########################################################

Malware uses names of legit processes to obfuscate itself. Give the flag located in Kerberos’ registry subkey.

HINT: Use Sysinternals tools.

Machine: Workstation1 (RDP from Admin-Station)
login: student
password: password

********************************************************* SOLUTION ********************************************************


HINT: Use Sysinternals tools.

Creds:

Machine: Workstation1 (RDP from Admin-Station)

login: student

password: password

- search for Kerberos in Autorun......... Right click and Jumpt to Entry------Click paramerts

- flag: H4d3S

OR

Open autoruns (sysinternals)

Search kerberos in search bar that says quick filter

Right click on Kerberos -> Jump to entry -> run as admin -> yes (do again if nothing happens)

Expand Kerberos folder on left-hand side -> click PARAMETERS

Flag: H4d3S

This is the path at the top: Computer\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Kerberos\Parameters



######################################################### Windows_Hidden_Processes_5 10 #########################################################

There is malware named TotallyLegit. Find its binary location and there will be a file in that directory. Read the file.

HINT: Use Sysinternals tools.

********************************************************* SOLUTION ********************************************************

HINT: Use Sysinternals tools.

- go to AutoRuns--- search for TotallyLegit

- right click and Jump to Entry

- this gives the path----- 
cd to the path 
type Hmmm.txt # read the contents of the file, same as cat 

L3gitness 

######################################################### Windows_Hidden_Processes_6 10 #########################################################

Find the McAfeeFireTray.exe. There is a file in that directory. The flag is inside.

HINT: Use Sysinternals tools.

Machine: Workstation1 (RDP from Admin-Station)
login: student
password: password

********************************************************* SOLUTION ********************************************************

use the search bar in autoruns to find the exe -> McAfeeFireTray.exe

then cd to the location SecureHealth (Not Verified) 	C:\Program Files\Windows Defender Advanced Threat Protection\McAfeeFireTray.exe	

type It's_Here.txt


- autorun search for the file----right click jump --- this gives file path

- C:\Program Files\Windows Defender Advanced Threat Protection

(Get-Acl "C:\Windows\System32\spoolsv.exe").Access | Where-Object { $_.IdentityReference -eq "NT SERVICE\TrustedInstaller" }

Get-ChildItem -Path C:\ -Recurse -Filter spoolsv.exe -ErrorAction SilentlyContinue | Where-Object { !$_.PSIsContainer }

######################################################### Win_Process_Situational_Awareness_1 10 #########################################################

What are the permissions for NT SERVICE\TrustedInstaller on spoolsv.exe? Copy the permissions from your shell.

HINT: Use Sysinternals tools.

********************************************************* SOLUTION ********************************************************

Get-ChildItem -Path C:\ -Recurse -Filter spoolsv.exe -ErrorAction SilentlyContinue | Where-Object { !$_.PSIsContainer } # Find where the file is


icacls "C:\windows\System32\spoolsv.exe" #which shows (F) for Full Control, answer will be Read Write for full control 


&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& another way &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

Get-Process | ? { $.Path -like '*spoolsv.exe' } | % { $.Handle }

Handle -> different everytime

Get-ChildItem -Path C:\ -Include "spoolsv" -File -Recurse #search for name of file

Directory: C:\Windows\System32\en-US

Cd C:\Windows\System32\en-US

(get-acl spoolsv.exe.mui).access | ft

Read,write

#OR

C:\Users\student\desktop\accesschk.exe C:\Windows\System32\spoolsv.exe

NT SERVICE\TrustedInstaller will show RW

#OR

Can also run:

icacls "C:\windows\System32\spoolsv.exe" #which shows (F) for Full Control #https://www.varonis.com/blog/ntfs-permissions-vs-share Full Control = read, write and change, does not include execute


######################################################### Win_Process_Situational_Awareness_2 10 #########################################################

What is the PATH listed in the output when we find the handle for spoolsv.exe?

HINT: Use Sysinternals tools and don't forget to run as Administrator...


********************************************************* SOLUTION ********************************************************


Open Process Explorer as administrator

Find spool in the top left search bar # view -> show lower pane 

C:\Windows\System32\en-US\spoolsv.exe.mui

Go to options > lower Pane > DLL

Under lowerpane find spoolsv.exe.mui

Right click properties and see path

C:\Windows\System32\en-US\spoolsv.exe.mui 

######################################################### Win_Process_Situational_Awareness_3 10 #########################################################



######################################################### Win_Process_Situational_Awareness_3 10 #########################################################

In what Load Order Group is the Windows Firewall service?

HINT: Use Sysinternals tools.

********************************************************* SOLUTION ********************************************************

net use * http://live.sysinternals.com
find loadOrder system tool 
look for the service name for windows firewall service on google, it should be MPSSVC. Now look at the group name
Answer should be Network Provider


######################################################### Win_Process_Situational_Awareness_4 10 #########################################################

What is the first .dll associated with winlogon.exe? Provide the name of the .dll only, not the /absolute/path

HINT: Use Sysinternals tools.

********************************************************* SOLUTION ********************************************************

open command prompt as administrator 

cd to the mounted directory 

listdlls -v winlogon.exe

look at the first dlls which is ntdll

######################################################### Win_Process_Situational_Awareness_5 10 #########################################################


While examining the Windows Defender Firewall, what is the LogAllowedConnections setting set to, for the Public profile?

********************************************************* SOLUTION ********************************************************

Got to windows start button and type windows Defender Firewall -> Advanced Settings -> Windows Defender Firewall Properties -> Specify Logging -> Log dropped packets set to no and Log successful connections set to NO. 

# tried this from powershell too->  Get-NetFirewallProfile 

# tried this from powershell too->   Get-NetFirewallProfile -Profile Public

######################################################### Windows_Hidden_Processes_7 10 #########################################################

A nonstandard port has been opened by possible malware on the system. Identify the port.

Machine: Workstation1 (RDP from Admin-Station)
login: student
password: password

********************************************************* SOLUTION ********************************************************

Standard are well known ports ---> ports between 0, 1023 or ports between 1024 to 49151


#Open tcpview sysinternal

#Notice that powershell.exe is listening on port 6666

#Powershell would use TCP/5985 = HTTP or TCP/5986 = HTTPS, so you know this one could be malware

6666

######################################################### Windows_Hidden_Processes_8 10 #########################################################

Determine what mechanism opened the port from hidden_processes_7. The flag is the name of the file.

Hint: The file is not legit.

Machine: Workstation1 (RDP from Admin-Station)
login: student
password: password

********************************************************* SOLUTION ********************************************************



 Run Task Scheduler as administrator

- On the right hand side “Display All Running Tasks”

- Notice GoogleUpdater current action is to run powershell ????

- Close and right click GoogleUpdater, Select properties

- Double click the actions, notice under arguments “-noexit -windowstyle hidden -File C:\windows\system32\legit_script.ps1”

legit_script.ps1


######################################################### Windows_File_System_Basics_13 15 #########################################################

Identify the flag from the file in hidden_processes_8.

********************************************************* SOLUTION ********************************************************

type legit_script.ps1 # see what the flag/comment is - > Th1s_1s_n0t_l3g1t


######################################################### Windows_Logs_4 15 #########################################################

How does a User-Mode Service request resources?

Research:

https://www.educative.io/answers/what-is-user-mode-vs-kernel-mode-in-an-operating-system

********************************************************* SOLUTION ********************************************************

system calls

######################################################### Windows_Boot_Remediate_2 10 #########################################################

Enter the full path of the program that was run on this computer from an abnormal location.

********************************************************* SOLUTION ********************************************************

shutdown /r

Get-Item HKLM:\SYSTEM\CurrentControlSet\Services\bam\UserSettings\*gar6

C:\Windows\Temp\bad_intentions.exe


######################################################################################################################################################
######################################################                                             ###################################################
######################################################                  10_windows_uac             ###################################################
######################################################                                             ###################################################
######################################################################################################################################################


######################################################### Windows_File_System_Basics_13 15 #########################################################

What Sysinternals tool will allow you to view a file's manifest?

********************************************************* SOLUTION ********************************************************

sigcheck

######################################################### Windows_UAC_Basics_2 5 #########################################################

What is the RequestedExecutionLevel for an application to run with the same permissions as the process that started it?

********************************************************* SOLUTION ********************************************************

asInvoker

######################################################### Windows_UAC_Basics_3 5 #########################################################

What RequestedExecutionLevel will prompt the user for Administrator credentials if they're not a member of the Administrator's group?

********************************************************* SOLUTION ********************************************************

requireAdministrator

######################################################### Windows_UAC_Basics_5 5 #########################################################

What registry key holds UAC values?

********************************************************* SOLUTION ********************************************************

HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System

######################################################### Windows_UAC_Basics_4 10 #########################################################

The flag is the RequestedExecutionLevel of the schtasks.exe file.

********************************************************* SOLUTION ********************************************************

Get-ChildItem -Path C:\ -Recurse -Filter schtasks.exe -ErrorAction SilentlyContinue | Where-Object { !$_.PSIsContainer } # Find where the schtasks.exe is 

net use * http://live.sysinternals.com

z:

./sigcheck -m C:\Windows\System32\schtasks.exe # Scroll down to see the description... the answer is asInvoker

######################################################### Windows_UAC_Basics_6 10 #########################################################


Determine which UAC subkey property shows whether UAC is enabled or not. The flag is the data value in that property.

Hint: Make sure you're on the file-server.

********************************************************* SOLUTION ********************************************************

Once on file server

Powershell

Get-ChildItem HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies

Get the value for EnableLUA -> 9194

$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

Cd HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies

ls -force

SEE —-> EnableLUA : 4919

EnableLUA – Shows if UAC is enable or not 

######################################################### Windows_UAC_Basics_7 10 #########################################################

Provide the name of the UAC [Registry subkey] property that determines what level UAC is set to for admin privileges (Example UAC levels: Default, Always, Notify).

********************************************************* SOLUTION ********************************************************


- Once on file server

Powershell

Get-ChildItem HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies

under system the answer should be ConsentPromptBehaviorAdmin

$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

1. Cd HKLM

2. Cd SOFTWARE\Microsoft\Windows\CurrentVersion\Policies

3. Ls -force ###to see the files/output

4. SEE —->ConsentPromptBehaviorAdmin (answ)

5 #this level of UAC is set to Default, Always, Notify

######################################################### Windows_UAC_Basics_8 10 #########################################################

Query the registry subkey where UAC settings are stored, and provide the flag.

********************************************************* SOLUTION ********************************************************



Once on file server

Powershell


Get-ChildItem HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies

under system the flag should be GoodJob

$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

Cd HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies

- this is where UAC setting are stored

ls -force 

######################################################################################################################################################
######################################################                                             ###################################################
######################################################            Windows UAC Basics 8             ###################################################
######################################################                                             ###################################################
######################################################################################################################################################

######################################################### Windows_UAC_Basics_8 10 #########################################################

What command-line (cmd) command will show service information?

********************************************************* SOLUTION ********************************************************

sc.exe

######################################################### Windows_Services_Basics_2 5  #########################################################

What command-line (cmd) command will show all services, running or not running?

The flag is the full command, for all services.

********************************************************* SOLUTION ********************************************************

sc queryex type=service state=all

######################################################### Windows_Services_Basics_3 5 #########################################################

What PowerShell command will list all services?

********************************************************* SOLUTION ********************************************************

Get-service

######################################################### Windows_Services_Basics_4 5 #########################################################

What registry location holds all service data?

********************************************************* SOLUTION ********************************************************

HKLM\SYSTEM\CurrentControlSet\Services

######################################################### Windows_Services_Basics_5 5 #########################################################

What registry subkey holds a service's .dll location?

The flag is the subkey name (full path not needed).

********************************************************* SOLUTION ********************************************************

HKLM\SYSTEM\CurrentControlSet\Services\<NAME>\Parameters

######################################################### Windows_Services_Basics_6 10 #########################################################

Services have a name and display name, which could be different. What is the service name of the only Totally-Legit service?

Reminder: All challenges are done using the file-server.

********************************************************* SOLUTION ********************************************************

ssh to the file-server

Get-service “Totally-Legit”

Name is Legit 

######################################################### Windows_Services_Basics_7 10 #########################################################


Figure out the SID of the only Totally-Legit service.

Example: S-1-5-80-159957745-2084983471-2137709666-960844832-[1182961511]

Submit only the [bracketed] portion of the SID.

HINT: Run the command on the service name, not the display name.

********************************************************* SOLUTION ********************************************************

sc.exe showsid “Legit” 

1182961511


######################################################################################################################################################
######################################################                                             ###################################################
######################################################        Windows Auditing and Logging         ###################################################
######################################################                                             ###################################################
######################################################################################################################################################


######################################################### Primer_Auditing_1 1 #########################################################

Logging, Auditing and Monitoring are often confused with each other but are distinctly different. Which term refers to real-time analysis and is often accomplished with a Security Event Information Management system (SIEM)?

********************************************************* SOLUTION ********************************************************

Monitoring

######################################################### Primer_Auditing_2 1 #########################################################

What term is most appropriate when referring to the process of reviewing log files or other records for specified period?

********************************************************* SOLUTION ********************************************************

Auditing

######################################################### Primer_Auditing_3 1 #########################################################

"Complete the following path to the Windows System Log which records system events e.g. startup and shutdown: %systemroot%\System32_______________

********************************************************* SOLUTION ********************************************************

%SystemRoot%\System32\Winevt\Logs\System.evtx


######################################################### Primer_Auditing_4 1 #########################################################

Which Windows log contains either success or failures and can be configured to record failed logon attempts?

********************************************************* SOLUTION ********************************************************

Security

######################################################### Primer_Auditing_5 1 #########################################################

"Which Windows account is the only account to have WRITE-APPEND access to Windows event logs?"

Resource: https://os.cybbh.io/public/os/latest/011_windows_auditing_&_logging/primer.html#_7_describe_the_systems_audit_policy


********************************************************* SOLUTION ********************************************************

NT AUTHORITY\SYSTEM

######################################################### Primer_Auditing_6 1 #########################################################

What is parsed in an NTFS object's security descriptor, by the Security Reference Monitor (SRM), to determine if an audit entry will be created in the Windows Security Log?

Research: https://learn.microsoft.com/en-us/windows/win32/secauthz/access-control-lists

********************************************************* SOLUTION ********************************************************

SACL --> Security Access Control List 

######################################################### Primer_Auditing_7 1 #########################################################

Which registry key holds the audit policy configuration? **Hint - Give full path

********************************************************* SOLUTION ********************************************************

HKLM\SECURITY\Policy\PolAdtEv

######################################################### Primer_Auditing_8 1 #########################################################

Which sysinternals tool is used to parse logs?

********************************************************* SOLUTION ********************************************************

PsLogList

(((((((((((((((((((((((())))))))))))))))))))))))
# Define the event ID for process creation
$eventId = 4688

# Define a list of normal locations (you may need to modify this list)
$normalLocations = @("C:\Windows\", "C:\Program Files\", "C:\Program Files (x86)\")

# Get the most recent 1000 events (you can adjust the number)
$events = Get-WinEvent -FilterHashtable @{LogName='Security'; ID=$eventId} -MaxEvents 1000

foreach ($event in $events) {
    # Convert the event to XML to access all its properties easily
    $eventXml = [xml]$event.ToXml()
    $commandLine = $eventXml.Event.EventData.Data | Where-Object { $_.Name -eq "CommandLine" }.'#text'
    $isNormalLocation = $false

    # Check if the command line starts with a path in one of the normal locations
    foreach ($location in $normalLocations) {
        if ($commandLine -like "$location*") {
            $isNormalLocation = $true
            break
        }
    }

    # Output the command line if it's not from a normal location
    if (-not $isNormalLocation) {
        Write-Output "Abnormal Execution: $commandLine"
    }
}



######################################################### Primer_Networking_1 1 #########################################################

What is used in Windows to implement the networking stack to enable communication with the four lowest OSI layers?

Research: https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc958797(v=technet.10)?redirectedfrom=MSDN

********************************************************* SOLUTION ********************************************************

NDIS

######################################################### Primer_Networking_2 1 #########################################################

What Windows cmd.exe command will display the local computer's routing table?

Research: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/netstat


********************************************************* SOLUTION ********************************************************

route print

######################################################### Primer_Networking_3 1 #########################################################

IANA assigned TCP/UDP ports in the range of 0-1023 that are usually associated with server-side services are known as?

Research: https://networkencyclopedia.com/well-known-port-numbers/

********************************************************* SOLUTION ********************************************************

well-known ports

######################################################### Primer_Networking_4 1 #########################################################

What term describes randomly assigned TCP/UDP ports above 1023 and are used for a short period of time (for the duration of a communication session}?

Research: https://en.wikipedia.org/wiki/Ephemeral_port

********************************************************* SOLUTION ********************************************************

ephemeral ports

######################################################### Primer_Networking_5 1 #########################################################

The two words that decribe translating Host names to IP addresses or NetBIOS names to IP addresses is_____?

Research: https://learn.microsoft.com/en-us/windows/win32/dns/name-resolution

********************************************************* SOLUTION ********************************************************

Name Resolution

######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************



######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************




######################################################### Primer_Surveys_3 1 #########################################################

What type of survey is focused on malware detection, artifact detection and investigating processes?

Research: https://learn.microsoft.com/en-us/security/compass/incident-response-overview

********************************************************* SOLUTION ********************************************************

Incident Response

######################################################### Windows_Browser_Artifacts_1 5 #########################################################

What Sysinternals tool will allow you to read the SQLite3 database containing the web history of chrome?

********************************************************* SOLUTION ********************************************************

Strings

######################################################### Windows_Recent_Files_1 5 #########################################################

What is the registry location of recent docs for the current user?

********************************************************* SOLUTION ********************************************************

HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs


######################################################### Windows_Bam_1 5 #########################################################


Challenge only allows ONE attempt

BAM settings are stored in different registry locations based on the version of Windows 10. What version of Windows 10 is workstation2 running? The answer is the 4 digit Windows 10 release (version) number.

********************************************************* SOLUTION ********************************************************

Get-ComputerInfo | select WindowsProductName, WindowsVersion, OsHardwareAbstractionLayer

1803 

######################################################### Windows_Last_Access 5 #########################################################

Figure out the last access time of the hosts file.

Flag format: mm/dd/yyyy

********************************************************* SOLUTION ********************************************************

Get-Childitem "C:\users\$env:username\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt" | select LastAccessTime


######################################################### Windows_Prefetch_1 5 #########################################################

What is the literal path of the prefetch directory?

********************************************************* SOLUTION ********************************************************

C:\Windows\Prefetch

######################################################### Windows_Recycle_Bin_1 5 #########################################################

In the Recycle Bin, there is a file that contains the actual contents of the recycled file. What are the first two characters of this filename?

********************************************************* SOLUTION ********************************************************

To see the content of the recycled folder

PS C:\> Get-Childitem 'C:\$RECYCLE.BIN' -Recurse -Verbose -Force | select FullName

Here, $R – gives the content of the deleted file

$I – gives the location of the file

Ans: $R 


######################################################### Windows_Recycle_Bin_2 5 #########################################################

In the Recycle Bin, there is a file that contains the original filename, path, file size, and when the file was deleted. What are the first two characters of this filename?

********************************************************* SOLUTION ********************************************************

ANS -> $I

The Recycle Bin on Windows systems uses metadata files to store information about deleted items. When a file is deleted, Windows stores information about the file in a hidden system folder named $Recycle.Bin. Each deleted file or folder is represented by a pair of files in the Recycle Bin:

    A metadata file that holds the original file name, original path, file size, and the date and time the file was deleted. This file has a name in the format $I<uniqueID>.
        The actual file itself, renamed to a unique ID that corresponds with the metadata file, with a name in the format $R<uniqueID>.

The $I files are INFO2 or $I###### files (where ###### is a placeholder for the unique ID) that contain the details you mentioned. Therefore, the first two characters of the filenames you're asking about are $I.

Please note that this information is valid for Windows systems, and the actual file structure and naming conventions may vary between different versions of Windows. Additionally, this information is correct as of the last update I have until April 2023, and it's also important to be aware that accessing the $Recycle.Bin folder typically requires administrative privileges.

    Navigate to the $Recycle.Bin folder at the root of each drive.
    Open the $Recycle.Bin folder, which contains subfolders named after the SID (Security Identifier) of each user who has deleted files.
    Inside these subfolders are the $I and $R files corresponding to each deleted item.

To programmatically access these files and read their contents, you would generally use specialized software or write a script to parse the data. It's important to handle this information with care, as improper access or modification could potentially cause issues with the operating system.


######################################################### Windows_UserAssist_1 5 #########################################################

What are the first 8 characters of the Globally Unique Identifier (GUID) used to list applications found in the UserAssist registry key (Windows 7 and later)?

********************************************************* SOLUTION ********************************************************

https://os.cybbh.io/public/os/latest/011_windows_auditing_&_logging/artifacts_fg.html#_5_prefetch
CEBFF5CD

######################################################### Windows_UserAssist_2 5 #########################################################

What cipher method are UserAssist files encoded in?

********************************************************* SOLUTION ********************************************************

They are located in HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{GUID}\Count\ * they are encoded in ROT13
https://os.cybbh.io/public/os/latest/011_windows_auditing_&_logging/artifacts_fg.html#_5_prefetch

######################################################### Windows_Logs_1 5 #########################################################

What main Windows log would show invalid login attempts?

********************************************************* SOLUTION ********************************************************

Security

######################################################### Windows_Logs_2 5 #########################################################

What main Windows log will show whether Windows updates were applied recently?

********************************************************* SOLUTION ********************************************************

System

######################################################### Windows_Logs_3 5 #########################################################

When reading logs, you may notice ... at the end of the line where the message is truncated. What format-table switch/argument will display the entire output?

Flag format: -argument

********************************************************* SOLUTION ********************************************************

-wrap

######################################################### Windows_Browser_Artifacts_2 10 #########################################################

Find the questionable website that a user browsed to (using Chrome), that appears to be malicious. *Note: There are more than one users on the box.

Machine: Workstation2 (ssh from Admin_Station)

********************************************************* SOLUTION ********************************************************

 Use this command to look for recent broweser hsitory and juts URL’s:

$History| Select-String -Pattern "(https|http):\/\/[a-zA-Z_0-9]+\.\w+[\.]?\w+" -AllMatches|foreach {$_.Matches.Groups[0].Value}| ft Anw: https://www.exploitdb.com

Or

Get-Content 'C:\users\student\AppData\Local\Google\Chrome\User Data\Default\History' https://www.exploit-db.com/ 

######################################################### Windows_Recent_Files_2 10 #########################################################

There is a file that was recently opened that may contain PII.

Get the flag from the contents of the file.

Hint: We're not interested in numbers.

********************************************************* SOLUTION ********************************************************

 Get-Item 'Registry::\HKEY_USERS\*\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.*' 

  Get-Item "REGISTRY::HKEY_USERS\*\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.txt" | select -Expand property | ForEach-Object {
>>
>> [System.Text.Encoding]::Default.GetString((Get-ItemProperty -Path "REGISTRY::HKEY_USERS\*\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.txt" -Name $_).$_)} # Get location for txt file 

ANS --> Flag, Find A.


((((((((((((((((((((((((((((((((((()))))))))))))))))))))))))))))))))))

Get-Item 'Registry::\HKEY_USERS\*\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.*'

We see the txt file was opened now to see where is the location of this file

Get-Item "REGISTRY::HKEY_USERS\*\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.txt" | select -Expand property | ForEach-Object {

[System.Text.Encoding]::Default.GetString((Get-ItemProperty -Path "REGISTRY::HKEY_USERS\*\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.txt" -Name $_).$_)}

C:\Users\student\Documents\3-14-24.txt

This gives us the location: Directory: C:\Users\student\Documents

Now change directory and rread the .txt file: PS C:\Users\student\Documents> Get-Content "3-14-24.txt"

Answ: Flag, Found A.

OR

Get-Item "REGISTRY::HKEY_USERS\\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.txt" | select -Expand property | ForEach-Object {[System.Text.Encoding]::Default.GetString((Get-ItemProperty -Path "REGISTRY::HKEY_USERS\\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.txt" -Name $).$)}

#returns the path of the file you need

cd C:\Users\student\Documents

ls

get-content 3-14-24.txt

Flag: Flag, Found A.



######################################################### Windows_Prefetch_2 10 #########################################################

Enter the name of the questionable file in the prefetch folder.


********************************************************* SOLUTION ********************************************************

PS C:\> Get-Childitem -Path 'C:\Windows\Prefetch' -ErrorAction Continue

BAD_INTENTIONS.EXE-8F2806FC.pf

######################################################### Windows_Prefetch_3 10 #########################################################

What is the creation time of the questionable file in the prefetch folder?

Flag format: mm/dd/yyyy

********************************************************* SOLUTION ********************************************************


Look to the left of the file.... 

2/23/2022  10:01 PM

######################################################### Windows_Recycle_Bin_3 10 #########################################################

Recover the flag from the Recycle Bin. Enter the name of the recycle bin file that contained the contents of the flag, and the contents of the deleted file.

Flag format: filename,contents


********************************************************* SOLUTION ********************************************************

Get-Childitem 'C:\$RECYCLE.BIN' -Recurse -Verbose -Force | select FullName | format-table -wra

Get-Content 'C:\$RECYCLE.BIN\S-1-5-21-2881336348-3190591231-4063445930-1003\$RZDAQ4U.txt'

$RZDAQ4U.txt,DontTrashMeyo

?????????????????????????????????????????????

(Get-Childitem 'C:\$RECYCLE.BIN' -Recurse -Verbose -Force | select FullName | format-table -wrap).count -> Gives the total number of files available

C:\$RECYCLE.BIN\S-1-5-21-2881336348-3190591231-4063445930-1003\$RZDAQ4U.txt

C:\$RECYCLE.BIN\S-1-5-21-2881336348-3190591231-4063445930-1003\$RZVLP5M.txt

Get-Content 'C:\$RECYCLE.BIN\S-1-5-21-2881336348-3190591231-4063445930-1003\$RZDAQ4U.txt'

Get-ChildItem 'C:\$RECYCLE.BIN' -Recurse -Force -Filter '*.txt' | Select-Object FullName | Format-Table -Wrap -AutoSize # Filter files based on txt 


######################################################### Windows_Jump_Lists 10 #########################################################

Find the file in the jump list location that might allow privilege escalation.


********************************************************* SOLUTION ********************************************************

Get-Childitem -Recurse C:\Users\*\AppData\Roaming\Microsoft\Windows\Recent -ErrorAction Continue | select FullName, LastAccessTime 

cd C:\Users\student\AppData\Roaming\Microsoft\Windows\Recent\AutomaticDestinations

######################################################### Primer_Boot_Process_2 1 #########################################################

cd C:\Users\student\AppData\Roaming\Microsoft\Windows\Recent\AutomaticDestinations

ls -force

Get-content .\5f7b5f1e01b81337.automaticDestinations-ms

UIDPWD.txt

((((((((((((((((()))))))))))))))))

5f7b5f1e01b81337.automaticDestinations-ms
5f7b5f1e01b83767.automaticDestinations-ms
f01b4d95cf55d32a.automaticDestinations-ms


Get-content 5f7b5f1e01b83767.automaticDestinations-ms

######################################################### Windows_Logs_4 15 #########################################################

Check event logs for a "flag" string.

Machine: file-server

********************************************************* SOLUTION ********************************************************

Get-Eventlog -LogName System | ft -wrap | findstr /i "flag"



######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************




######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************




######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************





######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************



######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************




######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************




######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************




######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************


######################################################################################################################################################
######################################################                                             ###################################################
######################################################              15_memory_analysis             ###################################################
######################################################                                             ###################################################
######################################################################################################################################################


######################################################### Primer_Networking_1 1 #########################################################

What is used in Windows to implement the networking stack to enable communication with the four lowest OSI layers?

Research: https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc958797(v=technet.10)?redirectedfrom=MSDN

********************************************************* SOLUTION ********************************************************

NDIS

######################################################### Primer_Networking_2 1 #########################################################

What Windows cmd.exe command will display the local computer's routing table?

Research: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/netstat


********************************************************* SOLUTION ********************************************************

route print

######################################################### Primer_Networking_3 1 #########################################################

IANA assigned TCP/UDP ports in the range of 0-1023 that are usually associated with server-side services are known as?

Research: https://networkencyclopedia.com/well-known-port-numbers/

********************************************************* SOLUTION ********************************************************

well-known ports

######################################################### Primer_Networking_4 1 #########################################################

What term describes randomly assigned TCP/UDP ports above 1023 and are used for a short period of time (for the duration of a communication session}?

Research: https://en.wikipedia.org/wiki/Ephemeral_port

********************************************************* SOLUTION ********************************************************

ephemeral ports

######################################################### Primer_Networking_5 1 #########################################################

The two words that decribe translating Host names to IP addresses or NetBIOS names to IP addresses is_____?

Research: https://learn.microsoft.com/en-us/windows/win32/dns/name-resolution

********************************************************* SOLUTION ********************************************************

Name Resolution


######################################################### Primer_Networking_6 1 #########################################################

What is the hierarchical service/protocol that translates hostnames to IP addresses?

Research: https://learn.microsoft.com/en-us/windows/win32/dns/dns-overview

********************************************************* SOLUTION ********************************************************

DNS

######################################################### Primer_Security_1 1 #########################################################

What is the term for the numeric value that the Windows OS uses to uniquely ID a user, group or computer?


********************************************************* SOLUTION ********************************************************

SID

######################################################### Primer_Security_2 1 #########################################################

What switch can be added to the CMD.exe command whoami, to view the SID of the current user?

Research: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/whoami

********************************************************* SOLUTION ********************************************************

/user

######################################################### Primer_Security_3 1 #########################################################

What is the value of a Relative Identifier (RID) assigned to the 1st user account?

https://os.cybbh.io/public/os/latest/013_memory_analysis/primer.html#_4_associate_a_user_sid_with_a_user_profile

********************************************************* SOLUTION ********************************************************

1000

######################################################### Primer_Security_4 1 #########################################################

What is the well known RID for the Windows Built-In Administrator Local account?

Research: https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-dtyp/81d92bba-d22b-4a8c-908a-554ab29148ab

********************************************************* SOLUTION ********************************************************



######################################################### Primer_Security_5 1 #########################################################

Complete the GET_CimInstance cmdlet to view all the user SIDs on a Windows host machine by Name and SID respectively:

Get-CimInstance Win32_UserAccount | Select-Obect ______________

**hint: the output will ONLY include Name and SID

********************************************************* SOLUTION ********************************************************

Name, SID


######################################################### Primer_Security_6 1 #########################################################

In Windows what else does a user's security Token contain?

SIDS of groups of which the user is a member
Privilege array
The Users _________ ?
**hint: Flag describes the unique number assigned to the user

Research: https://os.cybbh.io/public/os/latest/013_memory_analysis/primer.html#_1_1_security_identifiers_sids


********************************************************* SOLUTION ********************************************************

SID

######################################################### Primer_Security_7 1 #########################################################

When contained in a Windows users access token, what privilege does SeBackupPrivilege grant to the user to perform on files and folders?

**hint - flag is one word

Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/ifs/privileges


********************************************************* SOLUTION ********************************************************

Backup

######################################################### Primer_Security_8 1 #########################################################

Windows performs mandatory integrity checks (MICs) by comparing the integrity level of the resource with the integrity level of the calling process. Windows does this integrity check before the the objects discretionary access check because it is _____________?

Research: https://learn.microsoft.com/en-us/windows/win32/secauthz/mandatory-integrity-control

Hint: Opposite of slower


********************************************************* SOLUTION ********************************************************

faster

######################################################### Primer_Security_9 1 #########################################################

A Windows object's Security _________ contains:

The SID of the object's owner
Discretionary Access Control List (DACL)
System Access Control List (SACL)
Research: https://learn.microsoft.com/en-us/windows/win32/secauthz/security-descriptors

********************************************************* SOLUTION ********************************************************

Descriptor

######################################################### Primer_Security_10 1 #########################################################

What contains Access Control Entries (ACEs), that define the types of access a user or group may be granted to an object?

Research: https://learn.microsoft.com/en-us/windows/win32/secauthz/access-control-lists


********************************************************* SOLUTION ********************************************************

DACL

######################################################### Primer_Security_11 1 #########################################################

What cmdlet gets objects that represent the security descriptor of a file or resource?

Research: https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.security/get-acl?view=powershell-7.2

********************************************************* SOLUTION ********************************************************

Get-Acl

######################################################### Primer_Security_12 1 #########################################################

What NET cmd.exe command can be used to enumerate the local Windows group accounts?

Research: https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc725622(v=ws.11)

********************************************************* SOLUTION ********************************************************

net localgroup

######################################################### Primer_Security_13 1 #########################################################

Read and answer

https://ss64.com/nt/icacls.html

What Windows cmd.exe command will display or modify Access Control Lists (ACLs) for files and folders and resolves various issues that occur when using the older CACLS & XCACLS.

********************************************************* SOLUTION ********************************************************

ICACLS

######################################################### Primer_Security_14 1 #########################################################

Read and answer:

https://learn.microsoft.com/en-us/windows/win32/memory/data-execution-prevention

What Windows security feature is a system-level memory protection feature that is built into the operating system starting with Windows XP and Windows Server 2003 and enables the system to mark one or more pages of memory as non-executable?

********************************************************* SOLUTION ********************************************************

DEP

######################################################### Primer_Security_15 1 #########################################################

What computer security technique is used in Windows to prevent exploitation of memory corruption vulnerabilities? This feature randomly arranges the address space positions of key data areas of a process, in order to prevent an attacker from reliably jumping to, a particular exploited function in memory.

Research: https://www.mandiant.com/resources/blog/six-facts-about-address-space-layout-randomization-on-windows

********************************************************* SOLUTION ********************************************************

ASLR

######################################################### Primer_Security_16 1 #########################################################

What is a small kernel-mode library that can implement API hooking?

Research: https://techcommunity.microsoft.com/t5/ask-the-performance-team/demystifying-shims-or-using-the-app-compat-toolkit-to-make-your/ba-p/374947

********************************************************* SOLUTION ********************************************************

Shim

######################################################### Primer_Security_17 1 #########################################################

Read and Answer the next 4 challenges regarding Windows security features introduced in Windows 10 Creator's Update (Windows 10, version 1703)

https://learn.microsoft.com/en-us/windows/security/threat-protection/overview-of-threat-mitigations-in-windows-10

Which security feature helps keep attackers from gaining access through Pass-the-Hash or Pass-the-Ticket attacks using virtualization-based security to isolate secrets, such as NTLM password hashes and Kerberos Ticket Granting Tickets?

********************************************************* SOLUTION ********************************************************

Credential Guard

######################################################### Primer_Security_18 1 #########################################################

Introduced in Windows 8 this is Microsoft Antivirus, anti-malware solution?
Research: https://www.microsoft.com/en-us/windows/comprehensive-security

********************************************************* SOLUTION ********************************************************

Defender

######################################################### Primer_Security_19 1 #########################################################

What security technique helps prevent overwrites of the Structured Exception Handler?
Research: https://support.microsoft.com/en-us/topic/how-to-enable-structured-exception-handling-overwrite-protection-sehop-in-windows-operating-systems-8d4595f7-827f-72ee-8c34-fa8e0fe7b915

********************************************************* SOLUTION ********************************************************

SEHOP

######################################################### Primer_Security_20 1 #########################################################

What security protection is built into Windows 10, as described in the "Memory reservations" item in Kernel pool protections? This includes protecting address space 0x00000000 (not listed in article).
Hint: what is 0? Research: https://learn.microsoft.com/en-us/windows/win32/memory/reserving-and-committing-memory

********************************************************* SOLUTION ********************************************************

null page

######################################################### Primer_Security_21 1 #########################################################

Read and answer: https://learn.microsoft.com/en-us/windows/win32/wfp/windows-resource-protection-portal

What Windows security feature prevents the replacement of essential system files, folders, and registry keys that are installed as part of the operating system? It became available starting with Windows Server 2008 and Windows Vista.

********************************************************* SOLUTION ********************************************************

Windows Resource Protection

######################################################### Primer_Security_22 1 #########################################################

Read and answer: https://support.microsoft.com/en-us/topic/use-the-system-file-checker-tool-to-repair-missing-or-corrupted-system-files-79aa86cb-ca52-166a-92a3-966e85d4094e

What option should you use with the System File Checker cmd.exe tool sfc.exe to scan all protected system files, and replace corrupted files with a cached copy that is located in a compressed folder at %WinDir%\System32\dllcache ?

********************************************************* SOLUTION ********************************************************

/scannow

######################################################### Primer_Security_23 1 #########################################################

Where are copies of known-good critical system files located at %WinDir%___________ and used by the Windows Resource Protection feature?

hint: complete the path

Research: https://en.wikipedia.org/wiki/Windows_Resource_Protection https://learn.microsoft.com/en-us/windows-hardware/manufacture/desktop/clean-up-the-winsxs-folder?view=windows-11

********************************************************* SOLUTION ********************************************************

\WinSxS\Backup

######################################################### Primer_Networking_7 1 #########################################################

What CLI tool is often used to troubleshoot DNS issues but can also be used in reconnaissance?

Research: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/nslookup

********************************************************* SOLUTION ********************************************************

nslookup

######################################################### Primer_Networking_8 1 #########################################################

In Windows 10 what is the full path to the hosts file? Complete the path c:\Windows____________

Research: https://www.tenable.com/plugins/nessus/23910

********************************************************* SOLUTION ********************************************************

System32\drivers\etc\hosts

######################################################### Primer_Networking_9 1 #########################################################

Fill in the missing component for the usual Host Name Resolution order:

Client checks own host name
Client searches local Hosts file
______________________
NetBIOS name resolution sequence is used as a backup
Flag Format: Full name or acronym

Research: https://learn.microsoft.com/en-us/windows/win32/dns/dns-overview https://support.microsoft.com/en-us/topic/microsoft-tcp-ip-host-name-resolution-order-dae00cc9-7e9c-c0cc-8360-477b99cb978a


********************************************************* SOLUTION ********************************************************

Domain Name System (DNS) servers are queried.

######################################################### Primer_Networking_10 1 #########################################################

What cmd.exe tool will display NetBIOS transport statistics in Windows?

Research: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/nbtstat

********************************************************* SOLUTION ********************************************************

nbtstat

######################################################### Primer_Surveys_1 1 #########################################################

What team survey is focused on security and auditing?

______ Team

Research: https://www.coursera.org/articles/red-team-vs-blue-team


********************************************************* SOLUTION ********************************************************

Red

######################################################### Primer_Surveys_2 1 #########################################################

What type of survey is focused on computer system settings, updates, configurations and installed software?

________ Team

Research: https://ine.com/blog/understanding-blue-team-roles

********************************************************* SOLUTION ********************************************************

Blue

######################################################### Windows_Memory_Analysis_Plugin_1 5 #########################################################

What Volatility plugin will dump a process to an executable file sample?

********************************************************* SOLUTION ********************************************************

procdump

######################################################### Windows_Memory_Analysis_Plugin_2 5 #########################################################

What Volatility plugin will extract command history by scanning for _COMMAND_HISTORY?

********************************************************* SOLUTION ********************************************************

CmdScan

######################################################### Windows_Memory_Analysis_Plugin_3 5 #########################################################

What Volatility plugin will show driver objects?


********************************************************* SOLUTION ********************************************************

driverscan

######################################################### Windows_Memory_Analysis_Basics_2 5 #########################################################

What command do you run to find which memory profile to use with a memory image?


********************************************************* SOLUTION ********************************************************

imageinfo

######################################################### Windows_Memory_Analysis_Basics_1 5 #########################################################

What switch/argument will list all plugins for Volatility?

********************************************************* SOLUTION ********************************************************

-h

######################################################### Windows_Volatility_Data 5 #########################################################

In terms of Volatile Data, what locations are the MOST volatile?

Flag format: location,location

********************************************************* SOLUTION ********************************************************

CPU registers, cache

######################################################### Windows_Memory_Analysis_Basics_3 10 #########################################################

What is the 12th plugin listed in the Volatility help menu?

********************************************************* SOLUTION ********************************************************

cmdscan

######################################################### Windows_Memory_Analysis_Basics_4 10 #########################################################

What profile do you use in conjunction with this memory image?

Use the following file (memory image) to answer the rest of the Memory Analysis challenges.

0zapftis.vmem

********************************************************* SOLUTION ********************************************************

.\volatility_2.6_win64_standalone.exe -f ".\0zapftis.vmem" imageinfo

WinXPSP2x86

######################################################### Windows_File_System_Basics_13 15 #########################################################



********************************************************* SOLUTION ********************************************************

.\volatility_2.6_win64_standalone.exe -f ".\0zapftis.vmem" --profile=WinXPSP2x86 cmdscan

Cmd #1 @ 0x11135e8: sc query malware

Answer -> sc query malware

######################################################### Windows_Malware_2 10 #########################################################

What are the last 7 digits of the memory offset for the driver used by the malware?

********************************************************* SOLUTION ********************************************************

.\volatility_2.6_win64_standalone.exe -f ".\0zapftis.vmem" --profile=WinXPSP2x86 driverscan | findstr "malware"

Answer -> 1a498b8

######################################################### Windows_Malware_3 10 #########################################################

The process running under PID 544 seems malicious. What is the md5hash of the executable?

********************************************************* SOLUTION ********************************************************

# create a temporary folder called dump_folder before running this command
.\volatility_2.6_win64_standalone.exe -f ".\0zapftis.vmem" --profile=WinXPSP2x86 procdump -p 544 -D dump_folder 

#check the name of the executable under dump_folder before running generating the hash
certutil -hashfile dump_folder\executable.544.exe MD5


######################################################### Windows_Malware_4 10 #########################################################

What remote IP and port did the system connect to?

Flag format: ip:port

********************************************************* SOLUTION ********************************************************

.\volatility_2.6_win64_standalone.exe -f ".\0zapftis.vmem" --profile=WinXPSP2x86 connscan

Ans ->  172.16.98.1:6666






######################################################################################################################################################
######################################################                                             ###################################################
######################################################   16_windows_active_directory_enumeration   ###################################################
######################################################                                             ###################################################
######################################################################################################################################################


######################################################### Primer_Active_Directory_1 1 #########################################################

What is the database that is used to connect users with network resources?

Resources https://os.cybbh.io/public/os/latest/014_windows_active_directory_enumeration/primer.html

********************************************************* SOLUTION ********************************************************

Active Directory

######################################################### Primer_Active_Directory_2 1 #########################################################

What are all things that are in active directory stored as?

Resources https://os.cybbh.io/public/os/latest/014_windows_active_directory_enumeration/primer.html#_1_1_active_directory_structure

********************************************************* SOLUTION ********************************************************

objects

######################################################### Primer_Active_Directory_3 1 #########################################################

What is the Active Directory component which contains formal definitions of every object class that can be created in an Active Directory forest?

Resources https://os.cybbh.io/public/os/latest/014_windows_active_directory_enumeration/primer.html#_3_domains

********************************************************* SOLUTION ********************************************************

Schema

######################################################### Primer_Active_Directory_4 1 #########################################################

What protocol is used when accessing and updating the Active Directory?

Resources https://www.sciencedirect.com/topics/computer-science/directory-access-protocol

********************************************************* SOLUTION ********************************************************

LDAP

######################################################### Primer_Active_Directory_5 1 #########################################################

From an Offensive perspective, what type of account is usually the main target?

Resources https://os.cybbh.io/public/os/latest/014_windows_active_directory_enumeration/primer.html#_7_administrator_best_practices

********************************************************* SOLUTION ********************************************************

Administrator

######################################################### Primer_Active_Directory_6 1 #########################################################

Task : If an account has been inactive for a substantial amount of time what should the adminstrators do to the account?

Resources https://os.cybbh.io/public/os/latest/014_windows_active_directory_enumeration/primer.html#_11_impact_of_group_policy_settings


********************************************************* SOLUTION ********************************************************

Disable

######################################################### Primer_Active_Directory_7 1 #########################################################

What is the basic PowerShell cmdlet used to enumerate users?

Resources https://os.cybbh.io/public/os/latest/014_windows_active_directory_enumeration/primer.html#_2_2_powershell


********************************************************* SOLUTION ********************************************************

Get-ADUser

######################################################### Primer_Active_Directory_8 1 #########################################################

What is the suite of tools used in CLI to enumerate users across the network?

Resources https://os.cybbh.io/public/os/latest/014_windows_active_directory_enumeration/primer.html#_2_1_domain_service_ds_tools

********************************************************* SOLUTION ********************************************************

DS tools 

######################################################### Windows_Active_Directory_Basics_1 5 #########################################################

What is the domain portion of the following SID:

S-1-5-21-1004336348-1177238915-682003330-1000

********************************************************* SOLUTION ********************************************************

21-1004336348-1177238915-682003330

######################################################### Windows_Active_Directory_Basics_1 5 #########################################################

What PowerShell command will list domain groups?

********************************************************* SOLUTION ********************************************************

Get-ADGroup

######################################################### Windows_Active_Directory_Basics_2 5 #########################################################

What PowerShell command will list all users and their default properties?

The flag is the full command with arguments.

********************************************************* SOLUTION ********************************************************

Get-ADUser -Filter *

######################################################### Windows_Active_Directory_Basics_5 5 #########################################################

What PowerShell command will allow you to search Active Directory accounts for expired accounts without having to create a filter?

The flag is only the command, no arguments/switches.

********************************************************* SOLUTION ********************************************************

search-adaccount

######################################################### Windows_AD_Search_Accounts 10 #########################################################

Find the expired accounts that aren't disabled. List the last names in Alphabetical Order, separated with a comma, and no space between.

Flag format: name,name

Reminder: All challenges are done using the Domain-Controller

********************************************************* SOLUTION ********************************************************

search-adaccount -AccountExpired

- krause,page 

######################################################### Windows_AD_Search_Emails 10 #########################################################

Find the unprofessional email addresses. List the email's domain.

********************************************************* SOLUTION ********************************************************

Get-ADUser -Filter * -Properties emailaddress |select emailaddress

Get-ADUser -Filter * -Properties emailaddress | Where-Object { $_.emailaddress -notmatch '^[a-zA-Z]+\.[a-zA-Z]+\.mil@mail\.mil$' } | Select-Object emailaddress


Lewis.Hansen.mil@mail.mil

All the emails are mail.mil beside one which is ashleymadison.com ,just the email domain!

CharlieB@ashleymadison.com
Skyler01@ashleymadison.com

######################################################### Windows_AD_Search_Files 10 #########################################################

The flag is the unprofessionally-named file located somewhere on the Warrior Share.

Connect to the Warrior Share:

net use * "\\file-server\warrior share"

********************************************************* SOLUTION ********************************************************

 Connect to the Warrior Share: net use * "\\file-server\warrior share"

- to change the path to different drive: Set-Location -Path Z:/

- To get child items(folders/files) in current and all subdiretories of the Z drive

Get-ChildItem -path 'Z:\' -Recurse –Force 

Here, path ‘Z:\’ can be replaced with other drives or if we want to search for only pdf we can do ‘Z:\*.pdf’

After looking through all directory we see a file called

Lulz.pdf which seems unprofessional

https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-childitem?view=powershell-7.2

######################################################### Windows_AD_Search_Insider_2 10 #########################################################

The flag is the name of the user who is requesting modified access rights.

Connect to the Warrior Share:

net use * "\\file-server\warrior share"

Hint: Complete Windows_AD_Search_Insider_1 first.

********************************************************* SOLUTION ********************************************************

After connecting to the fileserver, we look through the directories, we know S6 handles all the access request so we go to brigade folder throught file path: \\file-server\warrior share\Brigade HQ\S-6 in file explored

Open the 14287 file using file explorer -> enter \\file-server\warrior share\Brigade HQ\S-6 to the file path... 
- We find pdf 14287.pdf, after opening this we see –K as the initial. Need to find the full name. To find full name we know tis email was regarding printer issues so lets see all the groups in this directory:

- Get-ADGroup -Filter * #Lists all the groups

- Get-ADgroupMember –Identity ‘Print Server Group’ -recursive #To see all the mmbers of this group

- To get the names and phonenumbers:

- Get-ADGroupMember -Identity 'Print Server Group' -recursive | select name, telephoneNumbers

- We find only one name with the name that has K

Karen,Nance

######################################################### Windows_AD_Search_Insider_1 10 #########################################################

The flag is the name of the file where someone is requesting modified access rights.

Connect to the Warrior Share:

net use * "\\file-server\warrior share"

********************************************************* SOLUTION ********************************************************

14287.pdf

######################################################### Windows_AD_Search_Naming 10 #########################################################

Find the accounts that contain unprofessional information in the description.

List the last names in Alphabetical Order, separated by a comma, with no space.

Flag format: name,name

********************************************************* SOLUTION ********************************************************

- To get the names of all the users along with description

get-aduser -filter * -Properties Description | select name, description


Alice.Brandywine    <=========|%%%%> Brigade S-6 Automations NCO <%%%%|=========>
Krystal.Jimenez     <------<< Brigade S-1 ACTIONS NCOIC |_|> >>------>

Brandywine,Jimenez

######################################################### Windows_AD_Search_Passwords 10 #########################################################


Find the following three accounts:

two accounts with passwords that never expire
one account that has its password stored using reversible encryption
List the last names in Alphabetical Order, comma-separated, no spaces. Do not list built-in accounts.

Flag format: name,name,name



********************************************************* SOLUTION ********************************************************

First look for the properties which you can use to filter through. The command to look for all the properties is:

Get-ADUser -filter * -Properties *

- After looking at all the properties we can see that properties we need is AllowReversiblePasswordEncryption and passwordneverexpires

- Now using these properties to find the answer # Filter using these properties and asking to give values if this property is set to true,We know not to use the built-in account


- Get-ADUser -filter 'passwordneverexpires -eq "true"'

- Get-ADUser -filter 'AllowReversiblePasswordEncryption -eq "true"'

Xavier.Ibarra -> passwordneverexpires
Eddie.Sanchez -> passwordneverexpires

Alice.Brandywine -> AllowReversiblePasswordEncryption

Brandywine,Ibarra,Sanchez

######################################################### Windows_AD_Search_PII 10 #########################################################

The flag is the name of the file containing PII on the Warrior Share.

Connect to the Warrior Share:

net use * "\\file-server\warrior share"

********************************************************* SOLUTION ********************************************************

to view all the files in directories and sub-directories:

Get-ChildItem -path 'Z:\' -Recurse –Force

Going through the files we can see phone_matrix.xlsx 

######################################################### Windows_Active_Directory_Basics_6 10 #########################################################

Find the short name of the domain in which this server is a part of.

********************************************************* SOLUTION ********************************************************

To find the name of the domain:

Get-WmiObject -Class win32_NTDomain

Ans: ARMY 

######################################################### Windows_Active_Directory_Basics_7 10 #########################################################


What is the RID of the krbtgt account.

Example: S-1-5-21-1004336348-1177238915-682003330-[501]


********************************************************* SOLUTION ********************************************************

Example: S-1-5-21-1004336348-1177238915-682003330-[501]

To filter the name “krbtgt” use the command:

get-aduser -filter 'Name -like "krbtgt"'

answer: 502 

######################################################### Windows_Active_Directory_Basics_3 10 #########################################################


How many users are members of the Domain Admins group?

HINT: No sub-groups.

********************************************************* SOLUTION ********************************************************
(Get-ADGroup "Domain Admins" -Properties *).Member.Count # There's a 1 level so subtract 1 you remain with 1. 

Get-ADGroupMember -Identity "domain admins"

asnw#1 

######################################################### Windows_Active_Directory_Basics_4 10 #########################################################

How many total users are members of the Domain Admins group?

********************************************************* SOLUTION ********************************************************

to get the number of people in Domain Admin group

Get-ADGroupMember -Identity 'Domain Admins' -Recursive

Now, to count

(Get-ADGroupMember -Identity 'Domain Admins' -Recursive).count

- 14 

######################################################### Windows_AD_Follow_Insider_Trail_1 15 #########################################################


Continue to follow the insider trail to find additional insider threats and their compromised mission.

The flag is the full name of the next insider threat identified.

HINT: Search the Active Directory record of the user identified in search_insider_2.

********************************************************* SOLUTION ********************************************************

Get-ADUser karen.nance -Properties *

Here, we see street address looks weird:

rkcrpg zl arkg pbzzhavpngvba ng 06:30 uef gbzbeebj zbeavat. Ybpngvba sbe qrgnvyf v aibyivat n uvtuyl pynffvsvrq bcrengvba hcybnqrq gb Gvssnal

rkcrpg zl arkg pbzzhavpngvba ng 06:30 uef gbzbeebj zbeavat. Ybpngvba sbe qrgnvyf vaibyivat n uvtuyl pynffvsvrq bcrengvba hcybnqrq gb Gvssnal . .

Now, using ROT13 to decipher we get message: expect my next communication at 06:30 hrs tomorrow morning. Location for details involving a highly classified operation uploaded to Tiffany

Now, we know tiffany is another user. To get more details of Tiffany:

Get-ADUser -filter "name -like 'Tiffany*'"

Tiffany.Bellacino

######################################################### Windows_AD_Follow_Insider_Trail_2 15 #########################################################

Continue to follow the insider trail to find additional insider threats and their compromised mission.

The flag is the username resulting from assembling clues within a user's records.

HINT: Search the Active Directory record of the user identified in follow_insider_trail_1. Piece together clues to identify another insider threat.

********************************************************* SOLUTION ********************************************************

To get more details on Tiffany:

Get-ADUser -filter "name -like 'Tiffany*'"-Properties * (DS) Tools
The flag is the full name of the insider threat identified.

HINT: Search the Active Directory record for the user identified in follow_insider_trail_2.

********************************************************* SOLUTION ********************************************************

Trying to get more information on Damian

- Get-ADUser -filter "name -like '*Damian*'" -Properties *

Here on the Info Section, we can see a note from Isiah. So, let find more information of Isiah

P0P SECRET - Star Wars Rogue One, opening night tomorrow!  Get em before they sell out! -Isiah

Get-ADUser -Filter "name -like '*Isiah*'"

Isiah.Jesus

######################################################### Windows_AD_Follow_Insider_Trail_4 15 #########################################################

Continue to follow the insider trail to find additional insider threats and their compromised mission. This flag is a video link.

Hint: Search the Active Directory record for the user identified in follow_insider_trail_3.

********************************************************* SOLUTION ********************************************************


Get-ADUser -filter "name -like '*Isiah*'"-Properties *
















Here, street address has some funky numbers: aHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj1kUXc0dzlXZ1hjUQ== Converting this
https://www.youtube.com/watch?v=dQw4w9WgXcQ

is from base64 it will give us: 











